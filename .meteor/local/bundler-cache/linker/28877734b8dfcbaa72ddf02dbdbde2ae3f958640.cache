[{"type":"js","data":"/* Imports for global scope */\n\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\n$ = Package.jquery.$;\njQuery = Package.jquery.jQuery;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nReactMeteorData = Package['react-meteor-data'].ReactMeteorData;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\n_ = Package.underscore._;\nDDP = Package['ddp-client'].DDP;\nLaunchScreen = Package['launch-screen'].LaunchScreen;\nBlaze = Package.ui.Blaze;\nUI = Package.ui.UI;\nHandlebars = Package.ui.Handlebars;\nSpacebars = Package.spacebars.Spacebars;\nTemplate = Package.templating.Template;\nmeteorInstall = Package.modules.meteorInstall;\nBuffer = Package.modules.Buffer;\nprocess = Package.modules.process;\nSymbol = Package['ecmascript-runtime'].Symbol;\nMap = Package['ecmascript-runtime'].Map;\nSet = Package['ecmascript-runtime'].Set;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nAccounts = Package['accounts-base'].Accounts;\nAutoupdate = Package.autoupdate.Autoupdate;\nReload = Package.reload.Reload;\nHTML = Package.htmljs.HTML;\n\n","servePath":"/packages/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"client\":{\"main.html\":function(){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/template.main.js                                                                                        //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\n                                                                                                                  // 1\nTemplate.body.addContent((function() {                                                                            // 2\n  var view = this;                                                                                                // 3\n  return HTML.Raw('<div id=\"app\"></div>');                                                                        // 4\n}));                                                                                                              // 5\nMeteor.startup(Template.body.renderToDocument);                                                                   // 6\n                                                                                                                  // 7\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"main.jsx\":[\"react\",\"meteor/meteor\",\"react-dom\",\"react-router\",\"../imports/startup/accounts-config.js\",\"../imports/ui/App.jsx\",\"../imports/ui/ChatBox.jsx\",function(require){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// client/main.jsx                                                                                                //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nvar _react = require('react');                                                                                    // 1\n                                                                                                                  //\nvar _react2 = _interopRequireDefault(_react);                                                                     //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 2\n                                                                                                                  //\nvar _reactDom = require('react-dom');                                                                             // 3\n                                                                                                                  //\nvar _reactRouter = require('react-router');                                                                       // 4\n                                                                                                                  //\nrequire('../imports/startup/accounts-config.js');                                                                 // 6\n                                                                                                                  //\nvar _App = require('../imports/ui/App.jsx');                                                                      // 7\n                                                                                                                  //\nvar _App2 = _interopRequireDefault(_App);                                                                         //\n                                                                                                                  //\nvar _ChatBox = require('../imports/ui/ChatBox.jsx');                                                              // 8\n                                                                                                                  //\nvar _ChatBox2 = _interopRequireDefault(_ChatBox);                                                                 //\n                                                                                                                  //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                 //\n                                                                                                                  //\n_meteor.Meteor.startup(function () {                                                                              // 10\n  (0, _reactDom.render)(_react2['default'].createElement(                                                         // 11\n    _reactRouter.Router,                                                                                          //\n    { history: _reactRouter.browserHistory },                                                                     //\n    _react2['default'].createElement(_reactRouter.Route, { path: '/', component: _App2['default'] }),             //\n    _react2['default'].createElement(_reactRouter.Route, { path: '/:friendId', component: _ChatBox2['default'] })\n  ), document.getElementById('app'));                                                                             //\n});                                                                                                               //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"imports\":{\"api\":{\"msgs.js\":[\"meteor/meteor\",\"meteor/mongo\",\"meteor/check\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/api/msgs.js                                                                                            //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\nexports.Msgs = undefined;                                                                                         //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 1\n                                                                                                                  //\nvar _mongo = require('meteor/mongo');                                                                             // 2\n                                                                                                                  //\nvar _check = require('meteor/check');                                                                             // 3\n                                                                                                                  //\nvar Msgs = exports.Msgs = new _mongo.Mongo.Collection('msgs');                                                    // 5\nif (_meteor.Meteor.isServer) {                                                                                    // 6\n  _meteor.Meteor.publish('msgs', function () {                                                                    // 7\n    function msgsPublication() {                                                                                  // 7\n      return Msgs.find({                                                                                          // 8\n        $or: [{ send_id: this.userId }, { recevier_id: this.userId }]                                             // 9\n      });                                                                                                         //\n    }                                                                                                             //\n                                                                                                                  //\n    return msgsPublication;                                                                                       //\n  }());                                                                                                           //\n  _meteor.Meteor.publish('chatMsgs', function () {                                                                // 15\n    function chatMsgsPublication(f_id) {                                                                          // 15\n      return Msgs.find({                                                                                          // 16\n        $or: [{ send_id: this.userId, recevier_id: f_id }, { send_id: f_id, recevier_id: this.userId }]           // 17\n      }).fetch();                                                                                                 //\n    }                                                                                                             //\n                                                                                                                  //\n    return chatMsgsPublication;                                                                                   //\n  }());                                                                                                           //\n}                                                                                                                 //\n                                                                                                                  //\n_meteor.Meteor.methods({                                                                                          // 25\n  'msgs.insert': function () {                                                                                    // 26\n    function msgsInsert(text, r_id) {                                                                             //\n      (0, _check.check)(text, String);                                                                            // 27\n                                                                                                                  //\n      if (!_meteor.Meteor.userId()) {                                                                             // 29\n        throw new _meteor.Meteor.Error('not-authorized');                                                         // 30\n      }                                                                                                           //\n                                                                                                                  //\n      Msgs.insert({                                                                                               // 33\n        send_id: _meteor.Meteor.userId(),                                                                         // 34\n        recevier_id: r_id,                                                                                        // 35\n        content: text,                                                                                            // 36\n        time: new Date(),                                                                                         // 37\n        isUnread: true                                                                                            // 38\n      });                                                                                                         //\n    }                                                                                                             //\n                                                                                                                  //\n    return msgsInsert;                                                                                            //\n  }()                                                                                                             //\n});                                                                                                               //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"users.js\":[\"meteor/meteor\",\"meteor/mongo\",\"meteor/check\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/api/users.js                                                                                           //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\nexports.Users = undefined;                                                                                        //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 1\n                                                                                                                  //\nvar _mongo = require('meteor/mongo');                                                                             // 2\n                                                                                                                  //\nvar _check = require('meteor/check');                                                                             // 3\n                                                                                                                  //\nvar Users = exports.Users = _meteor.Meteor.users;                                                                 // 5\nif (_meteor.Meteor.isServer) {                                                                                    // 6\n  _meteor.Meteor.publish('users', function () {                                                                   // 7\n    function usersPublication() {                                                                                 // 7\n      return Users.find({});                                                                                      // 8\n    }                                                                                                             //\n                                                                                                                  //\n    return usersPublication;                                                                                      //\n  }());                                                                                                           //\n  _meteor.Meteor.publish('findUser', function () {                                                                // 10\n    function findUserPublication(u_id) {                                                                          // 10\n      return Users.find({                                                                                         // 11\n        _id: u_id                                                                                                 // 12\n      });                                                                                                         //\n    }                                                                                                             //\n                                                                                                                  //\n    return findUserPublication;                                                                                   //\n  }());                                                                                                           //\n}                                                                                                                 //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"startup\":{\"accounts-config.js\":[\"meteor/accounts-base\",function(require){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/startup/accounts-config.js                                                                             //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nvar _accountsBase = require('meteor/accounts-base');                                                              // 1\n                                                                                                                  //\n_accountsBase.Accounts.ui.config({                                                                                // 3\n  passwordSignupFields: 'USERNAME_ONLY'                                                                           // 4\n});                                                                                                               //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"ui\":{\"AccountsUIWrapper.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"react-dom\",\"meteor/templating\",\"meteor/blaze\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/ui/AccountsUIWrapper.jsx                                                                               //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\n                                                                                                                  //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                           //\n                                                                                                                  //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                  //\n                                                                                                                  //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                     //\n                                                                                                                  //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                            //\n                                                                                                                  //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                       //\n                                                                                                                  //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                              //\n                                                                                                                  //\nvar _react = require('react');                                                                                    // 1\n                                                                                                                  //\nvar _react2 = _interopRequireDefault(_react);                                                                     //\n                                                                                                                  //\nvar _reactDom = require('react-dom');                                                                             // 2\n                                                                                                                  //\nvar _reactDom2 = _interopRequireDefault(_reactDom);                                                               //\n                                                                                                                  //\nvar _templating = require('meteor/templating');                                                                   // 3\n                                                                                                                  //\nvar _blaze = require('meteor/blaze');                                                                             // 4\n                                                                                                                  //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                 //\n                                                                                                                  //\nvar AccountsUIWrapper = function (_Component) {                                                                   //\n  (0, _inherits3['default'])(AccountsUIWrapper, _Component);                                                      //\n                                                                                                                  //\n  function AccountsUIWrapper() {                                                                                  //\n    (0, _classCallCheck3['default'])(this, AccountsUIWrapper);                                                    //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                  //\n  }                                                                                                               //\n                                                                                                                  //\n  AccountsUIWrapper.prototype.componentDidMount = function () {                                                   //\n    function componentDidMount() {                                                                                //\n      // Use Meteor Blaze to render login buttons                                                                 //\n      this.view = _blaze.Blaze.render(_templating.Template.loginButtons, _reactDom2['default'].findDOMNode(this.refs.container));\n    }                                                                                                             //\n                                                                                                                  //\n    return componentDidMount;                                                                                     //\n  }();                                                                                                            //\n                                                                                                                  //\n  AccountsUIWrapper.prototype.componentWillUnmount = function () {                                                // 6\n    function componentWillUnmount() {                                                                             //\n      // Clean up Blaze view                                                                                      //\n      _blaze.Blaze.remove(this.view);                                                                             // 14\n    }                                                                                                             //\n                                                                                                                  //\n    return componentWillUnmount;                                                                                  //\n  }();                                                                                                            //\n                                                                                                                  //\n  AccountsUIWrapper.prototype.render = function () {                                                              // 6\n    function render() {                                                                                           //\n      // Just render a placeholder container that will be filled in                                               //\n      return _react2['default'].createElement('span', { ref: 'container' });                                      // 18\n    }                                                                                                             //\n                                                                                                                  //\n    return render;                                                                                                //\n  }();                                                                                                            //\n                                                                                                                  //\n  return AccountsUIWrapper;                                                                                       //\n}(_react.Component);                                                                                              //\n                                                                                                                  //\nexports['default'] = AccountsUIWrapper;                                                                           //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"App.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"react-dom\",\"meteor/meteor\",\"meteor/react-meteor-data\",\"../api/msgs.js\",\"../api/users.js\",\"./MsgBox.jsx\",\"./AccountsUIWrapper.jsx\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/ui/App.jsx                                                                                             //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\n                                                                                                                  //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                           //\n                                                                                                                  //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                  //\n                                                                                                                  //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                     //\n                                                                                                                  //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                            //\n                                                                                                                  //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                       //\n                                                                                                                  //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                              //\n                                                                                                                  //\nvar _react = require('react');                                                                                    // 1\n                                                                                                                  //\nvar _react2 = _interopRequireDefault(_react);                                                                     //\n                                                                                                                  //\nvar _reactDom = require('react-dom');                                                                             // 2\n                                                                                                                  //\nvar _reactDom2 = _interopRequireDefault(_reactDom);                                                               //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 3\n                                                                                                                  //\nvar _reactMeteorData = require('meteor/react-meteor-data');                                                       // 4\n                                                                                                                  //\nvar _msgs = require('../api/msgs.js');                                                                            // 5\n                                                                                                                  //\nvar _users = require('../api/users.js');                                                                          // 6\n                                                                                                                  //\nvar _MsgBox = require('./MsgBox.jsx');                                                                            // 7\n                                                                                                                  //\nvar _MsgBox2 = _interopRequireDefault(_MsgBox);                                                                   //\n                                                                                                                  //\nvar _AccountsUIWrapper = require('./AccountsUIWrapper.jsx');                                                      // 8\n                                                                                                                  //\nvar _AccountsUIWrapper2 = _interopRequireDefault(_AccountsUIWrapper);                                             //\n                                                                                                                  //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                 //\n                                                                                                                  //\nvar App = function (_Component) {                                                                                 //\n  (0, _inherits3['default'])(App, _Component);                                                                    //\n                                                                                                                  //\n  function App(props) {                                                                                           // 10\n    (0, _classCallCheck3['default'])(this, App);                                                                  //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.call(this, props));                       //\n  }                                                                                                               //\n                                                                                                                  //\n  App.prototype.concatMsgs = function () {                                                                        // 9\n    function concatMsgs(msgs) {                                                                                   //\n      var _this2 = this;                                                                                          //\n                                                                                                                  //\n      var fList = [];                                                                                             // 15\n      var result = [];                                                                                            // 16\n      msgs.forEach(function (msg) {                                                                               // 17\n        var fId = msg.send_id == _this2.props.currentUser._id ? msg.recevier_id : msg.send_id;                    // 18\n        if (fList.indexOf(fId) < 0) {                                                                             // 19\n          fList.push(fId);                                                                                        // 20\n          result.push(msg);                                                                                       // 21\n        }                                                                                                         //\n      });                                                                                                         //\n      return result;                                                                                              // 24\n    }                                                                                                             //\n                                                                                                                  //\n    return concatMsgs;                                                                                            //\n  }();                                                                                                            //\n                                                                                                                  //\n  App.prototype.render = function () {                                                                            // 9\n    function render() {                                                                                           //\n      return _react2['default'].createElement(                                                                    // 28\n        'div',                                                                                                    //\n        { className: 'page-wrap' },                                                                               //\n        _react2['default'].createElement(_AccountsUIWrapper2['default'], null),                                   //\n        _react2['default'].createElement(_MsgBox2['default'], { msgs: this.concatMsgs(this.props.msgs) })         //\n      );                                                                                                          //\n    }                                                                                                             //\n                                                                                                                  //\n    return render;                                                                                                //\n  }();                                                                                                            //\n                                                                                                                  //\n  return App;                                                                                                     //\n}(_react.Component);                                                                                              //\n                                                                                                                  //\nApp.propTypes = {                                                                                                 // 37\n  msgs: _react.PropTypes.array.isRequired,                                                                        // 38\n  currentUser: _react.PropTypes.object                                                                            // 39\n};                                                                                                                //\n                                                                                                                  //\nexports['default'] = (0, _reactMeteorData.createContainer)(function () {                                          //\n  _meteor.Meteor.subscribe('msgs');                                                                               // 43\n  _meteor.Meteor.subscribe('users');                                                                              // 44\n  return {                                                                                                        // 45\n    msgs: _msgs.Msgs.find({}).fetch(),                                                                            // 46\n    currentUser: _meteor.Meteor.user()                                                                            // 47\n  };                                                                                                              //\n}, App);                                                                                                          //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"ChatBox.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/react-meteor-data\",\"react-dom\",\"meteor/meteor\",\"classnames\",\"./ChatBoxItem.jsx\",\"../api/users.js\",\"../api/msgs.js\",\"react-router\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/ui/ChatBox.jsx                                                                                         //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\n                                                                                                                  //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                           //\n                                                                                                                  //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                  //\n                                                                                                                  //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                     //\n                                                                                                                  //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                            //\n                                                                                                                  //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                       //\n                                                                                                                  //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                              //\n                                                                                                                  //\nvar _this2 = this;                                                                                                //\n                                                                                                                  //\nvar _react = require('react');                                                                                    // 1\n                                                                                                                  //\nvar _react2 = _interopRequireDefault(_react);                                                                     //\n                                                                                                                  //\nvar _reactMeteorData = require('meteor/react-meteor-data');                                                       // 2\n                                                                                                                  //\nvar _reactDom = require('react-dom');                                                                             // 3\n                                                                                                                  //\nvar _reactDom2 = _interopRequireDefault(_reactDom);                                                               //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 4\n                                                                                                                  //\nvar _classnames = require('classnames');                                                                          // 5\n                                                                                                                  //\nvar _classnames2 = _interopRequireDefault(_classnames);                                                           //\n                                                                                                                  //\nvar _ChatBoxItem = require('./ChatBoxItem.jsx');                                                                  // 6\n                                                                                                                  //\nvar _ChatBoxItem2 = _interopRequireDefault(_ChatBoxItem);                                                         //\n                                                                                                                  //\nvar _users = require('../api/users.js');                                                                          // 7\n                                                                                                                  //\nvar _msgs = require('../api/msgs.js');                                                                            // 8\n                                                                                                                  //\nvar _reactRouter = require('react-router');                                                                       // 9\n                                                                                                                  //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }                   //\n                                                                                                                  //\nvar ChatBox = function (_Component) {                                                                             //\n  (0, _inherits3['default'])(ChatBox, _Component);                                                                //\n                                                                                                                  //\n  function ChatBox() {                                                                                            //\n    (0, _classCallCheck3['default'])(this, ChatBox);                                                              //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                  //\n  }                                                                                                               //\n                                                                                                                  //\n  ChatBox.prototype.renderChatList = function () {                                                                //\n    function renderChatList() {                                                                                   //\n      var msgs = this.props.msgs;                                                                                 // 13\n      var friendName = this.props.friend[0] && this.props.friend[0].username;                                     // 14\n      if (!friendName) return;                                                                                    // 15\n      return msgs.map(function (msg) {                                                                            // 16\n        return _react2['default'].createElement(_ChatBoxItem2['default'], {                                       // 17\n          key: msg._id,                                                                                           // 19\n          msg: msg,                                                                                               // 20\n          friendName: friendName                                                                                  // 21\n        });                                                                                                       //\n      });                                                                                                         //\n    }                                                                                                             //\n                                                                                                                  //\n    return renderChatList;                                                                                        //\n  }();                                                                                                            //\n                                                                                                                  //\n  ChatBox.prototype.handleSubmit = function () {                                                                  // 11\n    function handleSubmit(event) {                                                                                //\n      event.preventDefault();                                                                                     // 28\n      var text = _reactDom2['default'].findDOMNode(this.refs.textInput).value.trim();                             // 29\n      var r_id = this.props.msgs[0].send_id === _meteor.Meteor.userId() ? this.props.msgs[0].recevier_id : this.props.msgs[0].send_id;\n      _meteor.Meteor.call('msgs.insert', text, r_id);                                                             // 31\n      _reactDom2['default'].findDOMNode(this.refs.textInput).value = '';                                          // 32\n    }                                                                                                             //\n                                                                                                                  //\n    return handleSubmit;                                                                                          //\n  }();                                                                                                            //\n                                                                                                                  //\n  ChatBox.prototype.render = function () {                                                                        // 11\n    function render() {                                                                                           //\n      return _react2['default'].createElement(                                                                    // 36\n        'div',                                                                                                    //\n        { className: 'chat-box' },                                                                                //\n        _react2['default'].createElement(                                                                         //\n          'h1',                                                                                                   //\n          { className: 'chat-box-tit' },                                                                          //\n          _react2['default'].createElement(                                                                       //\n            _reactRouter.Link,                                                                                    //\n            { className: 'chat-box-tit-back', to: '/' },                                                          //\n            '返回'                                                                                                  //\n          ),                                                                                                      //\n          this.props.friend[0] && this.props.friend[0].username                                                   //\n        ),                                                                                                        //\n        _react2['default'].createElement('ul', { className: 'chat-box-list' }),                                   //\n        _react2['default'].createElement(                                                                         //\n          'form',                                                                                                 //\n          { className: 'chat-box-msg', onSubmit: this.handleSubmit.bind(this) },                                  //\n          _react2['default'].createElement('input', { className: 'chat-box-msg-input', type: 'text', ref: 'textInput', placeholder: 'Type to add new Msgs' })\n        )                                                                                                         //\n      );                                                                                                          //\n    }                                                                                                             //\n                                                                                                                  //\n    return render;                                                                                                //\n  }();                                                                                                            //\n                                                                                                                  //\n  return ChatBox;                                                                                                 //\n}(_react.Component);                                                                                              //\n                                                                                                                  //\nChatBox.propTypes = {                                                                                             // 54\n  msgs: _react.PropTypes.array.isRequired,                                                                        // 55\n  friend: _react.PropTypes.array.isRequired                                                                       // 56\n};                                                                                                                //\n                                                                                                                  //\nexports['default'] = (0, _reactMeteorData.createContainer)(function () {                                          //\n  var f_id = _this2.location.pathname.slice(1);                                                                   // 60\n  var user_id = _meteor.Meteor.userId();                                                                          // 61\n  _meteor.Meteor.subscribe('users');                                                                              // 62\n  _meteor.Meteor.subscribe('findUsers', f_id);                                                                    // 63\n  _meteor.Meteor.subscribe('chatMsgs', f_id);                                                                     // 64\n  return {                                                                                                        // 65\n    msgs: _msgs.Msgs.find({                                                                                       // 66\n      $or: [{ send_id: user_id, recevier_id: f_id }, { send_id: f_id, recevier_id: user_id }]                     // 67\n    }).fetch(),                                                                                                   //\n    friend: _users.Users.find({ _id: f_id }).fetch()                                                              // 72\n  };                                                                                                              //\n}, ChatBox);                                                                                                      //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"ChatBoxItem.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/meteor\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/ui/ChatBoxItem.jsx                                                                                     //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\n                                                                                                                  //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                           //\n                                                                                                                  //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                  //\n                                                                                                                  //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                     //\n                                                                                                                  //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                            //\n                                                                                                                  //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                       //\n                                                                                                                  //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                              //\n                                                                                                                  //\nvar _react = require('react');                                                                                    // 1\n                                                                                                                  //\nvar _react2 = _interopRequireDefault(_react);                                                                     //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 2\n                                                                                                                  //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                 //\n                                                                                                                  //\nvar ChatBoxItem = function (_Component) {                                                                         //\n  (0, _inherits3['default'])(ChatBoxItem, _Component);                                                            //\n                                                                                                                  //\n  function ChatBoxItem() {                                                                                        //\n    (0, _classCallCheck3['default'])(this, ChatBoxItem);                                                          //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                  //\n  }                                                                                                               //\n                                                                                                                  //\n  ChatBoxItem.prototype.render = function () {                                                                    //\n    function render() {                                                                                           //\n      var msg = this.props.msg;                                                                                   // 7\n      var friendName = this.props.msg.send_id === _meteor.Meteor.userId() ? _meteor.Meteor.user().username : this.props.friendName;\n      return _react2['default'].createElement(                                                                    // 9\n        'li',                                                                                                     //\n        null,                                                                                                     //\n        _react2['default'].createElement(                                                                         //\n          'div',                                                                                                  //\n          { className: 'chat-wrap' },                                                                             //\n          _react2['default'].createElement(                                                                       //\n            'span',                                                                                               //\n            { className: 'chat-name' },                                                                           //\n            friendName                                                                                            //\n          ),                                                                                                      //\n          _react2['default'].createElement(                                                                       //\n            'span',                                                                                               //\n            { className: 'chat-time' },                                                                           //\n            msg.time.toLocaleDateString() + '  ' + msg.time.toLocaleTimeString()                                  //\n          ),                                                                                                      //\n          _react2['default'].createElement(                                                                       //\n            'p',                                                                                                  //\n            { className: 'chat-content' },                                                                        //\n            msg.content                                                                                           //\n          )                                                                                                       //\n        )                                                                                                         //\n      );                                                                                                          //\n    }                                                                                                             //\n                                                                                                                  //\n    return render;                                                                                                //\n  }();                                                                                                            //\n                                                                                                                  //\n  return ChatBoxItem;                                                                                             //\n}(_react.Component);                                                                                              //\n                                                                                                                  //\nexports['default'] = ChatBoxItem;                                                                                 //\n                                                                                                                  //\n                                                                                                                  //\nChatBoxItem.propTypes = {                                                                                         // 21\n  msg: _react.PropTypes.object.isRequired,                                                                        // 22\n  friendName: _react.PropTypes.string.isRequired                                                                  // 23\n};                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"MsgBox.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/meteor\",\"classnames\",\"./MsgBoxItem.jsx\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/ui/MsgBox.jsx                                                                                          //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\n                                                                                                                  //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                           //\n                                                                                                                  //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                  //\n                                                                                                                  //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                     //\n                                                                                                                  //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                            //\n                                                                                                                  //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                       //\n                                                                                                                  //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                              //\n                                                                                                                  //\nvar _react = require('react');                                                                                    // 1\n                                                                                                                  //\nvar _react2 = _interopRequireDefault(_react);                                                                     //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 2\n                                                                                                                  //\nvar _classnames = require('classnames');                                                                          // 3\n                                                                                                                  //\nvar _classnames2 = _interopRequireDefault(_classnames);                                                           //\n                                                                                                                  //\nvar _MsgBoxItem = require('./MsgBoxItem.jsx');                                                                    // 4\n                                                                                                                  //\nvar _MsgBoxItem2 = _interopRequireDefault(_MsgBoxItem);                                                           //\n                                                                                                                  //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                 //\n                                                                                                                  //\n// MsgBox component - represents user's msg list                                                                  //\n                                                                                                                  //\nvar MsgBox = function (_Component) {                                                                              //\n  (0, _inherits3['default'])(MsgBox, _Component);                                                                 //\n                                                                                                                  //\n  function MsgBox() {                                                                                             //\n    (0, _classCallCheck3['default'])(this, MsgBox);                                                               //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                  //\n  }                                                                                                               //\n                                                                                                                  //\n  MsgBox.prototype.renderMsgList = function () {                                                                  //\n    function renderMsgList() {                                                                                    //\n      var msgs = this.props.msgs;                                                                                 // 8\n      return msgs.map(function (msg) {                                                                            // 9\n        var f_id = msg.send_id == _meteor.Meteor.userId() ? msg.recevier_id : msg.send_id;                        // 10\n        return _react2['default'].createElement(_MsgBoxItem2['default'], {                                        // 11\n          key: msg._id,                                                                                           // 13\n          msg: msg                                                                                                // 14\n        });                                                                                                       //\n      });                                                                                                         //\n    }                                                                                                             //\n                                                                                                                  //\n    return renderMsgList;                                                                                         //\n  }();                                                                                                            //\n                                                                                                                  //\n  MsgBox.prototype.unreadMsgCount = function () {                                                                 // 6\n    function unreadMsgCount() {                                                                                   //\n      var msgs = this.props.msgs;                                                                                 // 20\n      var count = 0;                                                                                              // 21\n      msgs.forEach(function (msg) {                                                                               // 22\n        if (msg.isUnread) {                                                                                       // 23\n          count++;                                                                                                // 24\n        }                                                                                                         //\n      });                                                                                                         //\n      return count;                                                                                               // 27\n    }                                                                                                             //\n                                                                                                                  //\n    return unreadMsgCount;                                                                                        //\n  }();                                                                                                            //\n                                                                                                                  //\n  MsgBox.prototype.render = function () {                                                                         // 6\n    function render() {                                                                                           //\n      return _react2['default'].createElement(                                                                    // 30\n        'div',                                                                                                    //\n        { className: 'page msg-box' },                                                                            //\n        _react2['default'].createElement(                                                                         //\n          'h1',                                                                                                   //\n          { className: 'page-title' },                                                                            //\n          'My Messages',                                                                                          //\n          _react2['default'].createElement(                                                                       //\n            'div',                                                                                                //\n            { className: 'page-title_msg-count' },                                                                //\n            _react2['default'].createElement(                                                                     //\n              'span',                                                                                             //\n              { className: 'page-title_msg-count--unread' },                                                      //\n              ' ',                                                                                                //\n              this.unreadMsgCount(),                                                                              //\n              ' '                                                                                                 //\n            ),                                                                                                    //\n            ' / ',                                                                                                //\n            this.props.msgs.length                                                                                //\n          )                                                                                                       //\n        ),                                                                                                        //\n        _react2['default'].createElement(                                                                         //\n          'ul',                                                                                                   //\n          { className: 'msg-list' },                                                                              //\n          this.renderMsgList()                                                                                    //\n        )                                                                                                         //\n      );                                                                                                          //\n    }                                                                                                             //\n                                                                                                                  //\n    return render;                                                                                                //\n  }();                                                                                                            //\n                                                                                                                  //\n  return MsgBox;                                                                                                  //\n}(_react.Component);                                                                                              //\n                                                                                                                  //\nexports['default'] = MsgBox;                                                                                      //\n                                                                                                                  //\n                                                                                                                  //\nMsgBox.propTypes = {                                                                                              // 46\n  msgs: _react.PropTypes.array.isRequired                                                                         // 47\n};                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"MsgBoxItem.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"react-dom\",\"meteor/meteor\",\"meteor/react-meteor-data\",\"classnames\",\"../api/users.js\",\"react-router\",function(require,exports){\n\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                //\n// imports/ui/MsgBoxItem.jsx                                                                                      //\n//                                                                                                                //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                  //\nexports.__esModule = true;                                                                                        //\n                                                                                                                  //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                           //\n                                                                                                                  //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                  //\n                                                                                                                  //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                     //\n                                                                                                                  //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                            //\n                                                                                                                  //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                       //\n                                                                                                                  //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                              //\n                                                                                                                  //\nvar _react = require('react');                                                                                    // 1\n                                                                                                                  //\nvar _react2 = _interopRequireDefault(_react);                                                                     //\n                                                                                                                  //\nvar _reactDom = require('react-dom');                                                                             // 2\n                                                                                                                  //\nvar _reactDom2 = _interopRequireDefault(_reactDom);                                                               //\n                                                                                                                  //\nvar _meteor = require('meteor/meteor');                                                                           // 3\n                                                                                                                  //\nvar _reactMeteorData = require('meteor/react-meteor-data');                                                       // 4\n                                                                                                                  //\nvar _classnames = require('classnames');                                                                          // 5\n                                                                                                                  //\nvar _classnames2 = _interopRequireDefault(_classnames);                                                           //\n                                                                                                                  //\nvar _users = require('../api/users.js');                                                                          // 6\n                                                                                                                  //\nvar _reactRouter = require('react-router');                                                                       // 7\n                                                                                                                  //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                 //\n                                                                                                                  //\n// MsgBoxItem component - represents msg item of user's msgBox list                                               //\n                                                                                                                  //\nvar MsgBoxItem = function (_Component) {                                                                          //\n  (0, _inherits3['default'])(MsgBoxItem, _Component);                                                             //\n                                                                                                                  //\n  function MsgBoxItem() {                                                                                         //\n    (0, _classCallCheck3['default'])(this, MsgBoxItem);                                                           //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                  //\n  }                                                                                                               //\n                                                                                                                  //\n  MsgBoxItem.prototype.render = function () {                                                                     //\n    function render() {                                                                                           //\n      var msg = this.props.msg;                                                                                   // 11\n      var itemClassName = (0, _classnames2['default'])({                                                          // 12\n        'msg-item': true,                                                                                         // 13\n        'msg-item--unread': msg.isUnread                                                                          // 14\n      });                                                                                                         //\n      f_id = msg.send_id == _meteor.Meteor.userId() ? msg.recevier_id : msg.send_id;                              // 16\n      return _react2['default'].createElement(                                                                    // 17\n        'li',                                                                                                     //\n        { className: itemClassName },                                                                             //\n        _react2['default'].createElement(                                                                         //\n          _reactRouter.Link,                                                                                      //\n          { to: '/' + f_id },                                                                                     //\n          _react2['default'].createElement(                                                                       //\n            'div',                                                                                                //\n            { className: 'msg-item_name' },                                                                       //\n            ' ',                                                                                                  //\n            this.props.friend[0] && this.props.friend[0].username,                                                //\n            ' '                                                                                                   //\n          ),                                                                                                      //\n          _react2['default'].createElement(                                                                       //\n            'div',                                                                                                //\n            { className: 'msg-item_content' },                                                                    //\n            _react2['default'].createElement(                                                                     //\n              'span',                                                                                             //\n              { className: 'msg-item_time' },                                                                     //\n              ' ',                                                                                                //\n              msg.time.toLocaleDateString() + '  ' + msg.time.toLocaleTimeString()                                //\n            ),                                                                                                    //\n            _react2['default'].createElement(                                                                     //\n              'p',                                                                                                //\n              null,                                                                                               //\n              msg.content,                                                                                        //\n              ' '                                                                                                 //\n            )                                                                                                     //\n          )                                                                                                       //\n        )                                                                                                         //\n      );                                                                                                          //\n    }                                                                                                             //\n                                                                                                                  //\n    return render;                                                                                                //\n  }();                                                                                                            //\n                                                                                                                  //\n  return MsgBoxItem;                                                                                              //\n}(_react.Component);                                                                                              //\n                                                                                                                  //\nMsgBoxItem.propTypes = {                                                                                          // 31\n  msg: _react.PropTypes.object.isRequired,                                                                        // 32\n  friend: _react.PropTypes.array.isRequired                                                                       // 33\n};                                                                                                                //\n                                                                                                                  //\nexports['default'] = (0, _reactMeteorData.createContainer)(function () {                                          //\n  _meteor.Meteor.subscribe('users');                                                                              // 38\n  _meteor.Meteor.subscribe('findUsers', f_id);                                                                    // 39\n  return {                                                                                                        // 40\n    friend: _users.Users.find({ _id: f_id }).fetch()                                                              // 41\n  };                                                                                                              //\n}, MsgBoxItem);                                                                                                   //\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]}}},{\"extensions\":[\".js\",\".json\",\".html\",\".jsx\",\".less\"]});\nrequire(\"./client/main.html\");\nrequire(\"./client/main.jsx\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["/client/main.jsx","/imports/api/msgs.js","/imports/api/users.js","/imports/startup/accounts-config.js","/imports/ui/AccountsUIWrapper.jsx","/imports/ui/App.jsx","/imports/ui/ChatBox.jsx","/imports/ui/ChatBoxItem.jsx","/imports/ui/MsgBox.jsx","/imports/ui/MsgBoxItem.jsx"],"names":[],"mappings":"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","file":"/app.js","sourcesContent":["import React from 'react';\nimport { Meteor } from 'meteor/meteor';\nimport { render } from 'react-dom';\nimport { Router, Route, browserHistory } from 'react-router'\n \nimport '../imports/startup/accounts-config.js'\nimport App from '../imports/ui/App.jsx'\nimport ChatBox from '../imports/ui/ChatBox.jsx'\n \nMeteor.startup(() => {\n  render((\n    <Router history={browserHistory}>\n      <Route path=\"/\" component={App} />\n      <Route path=\"/:friendId\" component={ChatBox} />\n    </Router>), document.getElementById('app'))\n});","import { Meteor } from 'meteor/meteor'\nimport { Mongo } from 'meteor/mongo'\nimport { check } from 'meteor/check'\n \nexport const Msgs = new Mongo.Collection('msgs');\nif (Meteor.isServer) {\n  Meteor.publish('msgs', function msgsPublication() {\n    return Msgs.find({\n      $or: [\n        { send_id: this.userId },\n        { recevier_id: this.userId },\n      ],\n    })\n  })\n  Meteor.publish('chatMsgs', function chatMsgsPublication(f_id) {\n    return Msgs.find({\n      $or: [\n        {send_id: this.userId, recevier_id: f_id}, \n        {send_id: f_id, recevier_id: this.userId}\n      ] \n    }).fetch()\n  })\n}\n \nMeteor.methods({\n  'msgs.insert'(text, r_id) {\n    check(text, String)\n\n    if (! Meteor.userId()) {\n      throw new Meteor.Error('not-authorized')\n    }\n\n    Msgs.insert({\n      send_id: Meteor.userId(),\n      recevier_id: r_id,\n      content: text,\n      time: new Date(),\n      isUnread: true\n    })\n  }\n})","import { Meteor } from 'meteor/meteor'\nimport { Mongo } from 'meteor/mongo'\nimport { check } from 'meteor/check'\n \nexport const Users = Meteor.users;\nif (Meteor.isServer) {\n  Meteor.publish('users', function usersPublication() {\n    return Users.find({})\n  })\n  Meteor.publish('findUser', function findUserPublication(u_id) {\n    return Users.find({\n      _id: u_id\n    });\n  })\n} \n","import { Accounts } from 'meteor/accounts-base';\n \nAccounts.ui.config({\n  passwordSignupFields: 'USERNAME_ONLY',\n});","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Template } from 'meteor/templating';\nimport { Blaze } from 'meteor/blaze';\n \nexport default class AccountsUIWrapper extends Component {\n  componentDidMount() {\n    // Use Meteor Blaze to render login buttons\n    this.view = Blaze.render(Template.loginButtons,\n      ReactDOM.findDOMNode(this.refs.container));\n  }\n  componentWillUnmount() {\n    // Clean up Blaze view\n    Blaze.remove(this.view);\n  }\n  render() {\n    // Just render a placeholder container that will be filled in\n    return <span ref=\"container\" />;\n  }\n}","import React, { Component, PropTypes } from 'react'\nimport ReactDOM from 'react-dom'\nimport { Meteor } from 'meteor/meteor'\nimport { createContainer } from 'meteor/react-meteor-data'\nimport { Msgs } from '../api/msgs.js'\nimport { Users } from '../api/users.js'\nimport MsgBox from './MsgBox.jsx'\nimport AccountsUIWrapper from './AccountsUIWrapper.jsx'\nclass App extends Component {\n  constructor(props) {\n    super(props)\n  }\n\n  concatMsgs (msgs) {\n    let fList = []\n    let result = []\n    msgs.forEach((msg) => {\n      let fId = msg.send_id == this.props.currentUser._id ? msg.recevier_id : msg.send_id\n      if(fList.indexOf(fId) < 0){\n        fList.push(fId)\n        result.push(msg)\n      }\n    })\n    return result\n  }\n\n  render() {\n    return (\n      <div className=\"page-wrap\">\n        <AccountsUIWrapper />\n        <MsgBox msgs={ this.concatMsgs(this.props.msgs) }/>\n      </div> \n    );\n  }\n}\n \nApp.propTypes = {\n  msgs: PropTypes.array.isRequired,\n  currentUser: PropTypes.object,\n};\n \nexport default createContainer(() => {\n  Meteor.subscribe('msgs')\n  Meteor.subscribe('users')\n  return {\n    msgs: Msgs.find({}).fetch(),\n    currentUser: Meteor.user(),\n  };\n}, App);","import React, { Component, PropTypes } from 'react'\nimport { createContainer } from 'meteor/react-meteor-data'\nimport ReactDOM from 'react-dom'\nimport { Meteor } from 'meteor/meteor'\nimport classnames from 'classnames'\nimport ChatBoxItem from './ChatBoxItem.jsx'\nimport { Users } from \"../api/users.js\"\nimport { Msgs } from \"../api/msgs.js\"\nimport { Link } from 'react-router'\n\nclass ChatBox extends Component {\n  renderChatList() {\n    let msgs = this.props.msgs\n    let friendName = this.props.friend[0] && this.props.friend[0].username\n    if(!friendName) return\n    return msgs.map((msg) => {\n      return (\n        <ChatBoxItem\n         key={msg._id}\n         msg={msg}\n         friendName={friendName}\n        />\n      )\n    })\n  }\n\n  handleSubmit(event) {\n    event.preventDefault()\n    const text = ReactDOM.findDOMNode(this.refs.textInput).value.trim()\n    let r_id = this.props.msgs[0].send_id === Meteor.userId() ? this.props.msgs[0].recevier_id : this.props.msgs[0].send_id\n    Meteor.call('msgs.insert', text, r_id)\n    ReactDOM.findDOMNode(this.refs.textInput).value = ''\n  }\n\n  render() {\n    return (\n      <div className=\"chat-box\">\n        <h1 className=\"chat-box-tit\">\n          <Link className=\"chat-box-tit-back\" to={'/'}>返回</Link>\n          { this.props.friend[0] && this.props.friend[0].username }\n        </h1>\n        <ul className=\"chat-box-list\">\n          \n        </ul>\n        <form className=\"chat-box-msg\" onSubmit={this.handleSubmit.bind(this)}>\n          <input className=\"chat-box-msg-input\" type=\"text\" ref=\"textInput\" placeholder=\"Type to add new Msgs\"/>\n        </form>\n      </div>\n    )\n  } \n}\n\n\nChatBox.propTypes = {\n  msgs: PropTypes.array.isRequired,\n  friend: PropTypes.array.isRequired\n}\n\nexport default createContainer(() => {\n  let f_id = this.location.pathname.slice(1)\n  let user_id = Meteor.userId()\n  Meteor.subscribe('users')\n  Meteor.subscribe('findUsers', f_id)\n  Meteor.subscribe('chatMsgs', f_id)\n  return {\n    msgs: Msgs.find({\n      $or: [\n        { send_id: user_id, recevier_id: f_id},\n        { send_id: f_id, recevier_id: user_id }\n      ],\n    }).fetch(),\n    friend: Users.find({_id:f_id}).fetch()\n  }\n}, ChatBox)\n","import React, { Component, PropTypes } from 'react'\nimport { Meteor } from 'meteor/meteor'\n\n\nexport default class ChatBoxItem extends Component {\n  render() {\n    const msg = this.props.msg\n    const friendName = this.props.msg.send_id === Meteor.userId() ? Meteor.user().username : this.props.friendName\n    return (\n      <li>\n        <div className=\"chat-wrap\">\n          <span className=\"chat-name\">{ friendName }</span>\n          <span className=\"chat-time\">{ `${msg.time.toLocaleDateString()}  ${msg.time.toLocaleTimeString()}` }</span>\n          <p className=\"chat-content\">{ msg.content }</p>\n        </div>\n      </li>\n    )\n  }\n}\n\nChatBoxItem.propTypes = {\n  msg: PropTypes.object.isRequired,\n  friendName: PropTypes.string.isRequired\n}\n\n","import React, { Component, PropTypes } from 'react'\nimport { Meteor } from 'meteor/meteor'\nimport classnames from 'classnames'\nimport MsgBoxItem from \"./MsgBoxItem.jsx\"\n// MsgBox component - represents user's msg list\nexport default class MsgBox extends Component {\n  renderMsgList () {\n    let msgs = this.props.msgs\n    return msgs.map((msg) => {\n      let f_id = msg.send_id == Meteor.userId() ? msg.recevier_id : msg.send_id\n      return (\n        <MsgBoxItem\n          key={msg._id}\n          msg={msg}\n        />\n      )\n    })\n  }\n  unreadMsgCount () {\n    let msgs = this.props.msgs\n    let count = 0\n    msgs.forEach(function(msg) {\n      if(msg.isUnread) {\n        count++\n      }\n    })\n    return count\n  }\n  render () {\n    return (\n      <div className=\"page msg-box\">\n        <h1 className=\"page-title\">\n          My Messages\n          <div className=\"page-title_msg-count\">\n            <span className=\"page-title_msg-count--unread\"> { this.unreadMsgCount() } </span> / { this.props.msgs.length }\n          </div>\n        </h1>\n        <ul className=\"msg-list\">  \n          { this.renderMsgList() }\n        </ul>\n      </div>\n    )\n  }\n}\n \nMsgBox.propTypes = {\n  msgs: PropTypes.array.isRequired\n}","import React, { Component, PropTypes } from 'react'\nimport ReactDOM from 'react-dom'\nimport { Meteor } from 'meteor/meteor'\nimport { createContainer } from 'meteor/react-meteor-data'\nimport classnames from 'classnames'\nimport { Users } from '../api/users.js'\nimport { Link } from 'react-router'\n// MsgBoxItem component - represents msg item of user's msgBox list\nclass MsgBoxItem extends Component {\n  render () {\n    const msg = this.props.msg\n    const itemClassName = classnames({\n      'msg-item': true,\n      'msg-item--unread': msg.isUnread\n    })\n    f_id = msg.send_id == Meteor.userId() ? msg.recevier_id : msg.send_id\n    return (\n      <li className={itemClassName}>\n        <Link to={`/${f_id}`}>\n        <div className=\"msg-item_name\"> { this.props.friend[0] && this.props.friend[0].username } </div> \n        <div className=\"msg-item_content\"> \n          <span className=\"msg-item_time\"> { `${msg.time.toLocaleDateString()}  ${msg.time.toLocaleTimeString()}` }</span>\n          <p>{ msg.content } </p>\n        </div>  \n        </Link>\n      </li>\n    )\n  }\n}\n \nMsgBoxItem.propTypes = {\n  msg: PropTypes.object.isRequired,\n  friend: PropTypes.array.isRequired\n}\n\n\nexport default createContainer(() => {\n  Meteor.subscribe('users')\n  Meteor.subscribe('findUsers', f_id)\n  return {\n    friend: Users.find({_id:f_id}).fetch()\n  }\n}, MsgBoxItem)\n"]}}]