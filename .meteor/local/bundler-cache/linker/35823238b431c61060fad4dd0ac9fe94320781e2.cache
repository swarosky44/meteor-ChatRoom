[{"type":"js","data":"/* Imports for global scope */\n\nMongo = Package.mongo.Mongo;\nReactiveVar = Package['reactive-var'].ReactiveVar;\n$ = Package.jquery.$;\njQuery = Package.jquery.jQuery;\nTracker = Package.tracker.Tracker;\nDeps = Package.tracker.Deps;\nReactMeteorData = Package['react-meteor-data'].ReactMeteorData;\nMeteor = Package.meteor.Meteor;\nglobal = Package.meteor.global;\nmeteorEnv = Package.meteor.meteorEnv;\nWebApp = Package.webapp.WebApp;\n_ = Package.underscore._;\nDDP = Package['ddp-client'].DDP;\nLaunchScreen = Package['launch-screen'].LaunchScreen;\nBlaze = Package.ui.Blaze;\nUI = Package.ui.UI;\nHandlebars = Package.ui.Handlebars;\nSpacebars = Package.spacebars.Spacebars;\nTemplate = Package.templating.Template;\nmeteorInstall = Package.modules.meteorInstall;\nBuffer = Package.modules.Buffer;\nprocess = Package.modules.process;\nSymbol = Package['ecmascript-runtime'].Symbol;\nMap = Package['ecmascript-runtime'].Map;\nSet = Package['ecmascript-runtime'].Set;\nmeteorBabelHelpers = Package['babel-runtime'].meteorBabelHelpers;\nPromise = Package.promise.Promise;\nAccounts = Package['accounts-base'].Accounts;\nAutoupdate = Package.autoupdate.Autoupdate;\nReload = Package.reload.Reload;\nHTML = Package.htmljs.HTML;\n\n","servePath":"/packages/global-imports.js"},{"type":"js","data":"var require = meteorInstall({\"client\":{\"main.html\":function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// client/template.main.js                                                                                          //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\n                                                                                                                    // 1\nTemplate.body.addContent((function() {                                                                              // 2\n  var view = this;                                                                                                  // 3\n  return HTML.Raw('<div id=\"app\"></div>');                                                                          // 4\n}));                                                                                                                // 5\nMeteor.startup(Template.body.renderToDocument);                                                                     // 6\n                                                                                                                    // 7\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"main.jsx\":[\"react\",\"meteor/meteor\",\"react-dom\",\"react-router\",\"../imports/startup/accounts-config.js\",\"../imports/ui/App.jsx\",\"../imports/ui/ChatBox.jsx\",function(require){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// client/main.jsx                                                                                                  //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nvar _react = require('react');                                                                                      // 1\n                                                                                                                    //\nvar _react2 = _interopRequireDefault(_react);                                                                       //\n                                                                                                                    //\nvar _meteor = require('meteor/meteor');                                                                             // 2\n                                                                                                                    //\nvar _reactDom = require('react-dom');                                                                               // 3\n                                                                                                                    //\nvar _reactRouter = require('react-router');                                                                         // 4\n                                                                                                                    //\nrequire('../imports/startup/accounts-config.js');                                                                   // 6\n                                                                                                                    //\nvar _App = require('../imports/ui/App.jsx');                                                                        // 7\n                                                                                                                    //\nvar _App2 = _interopRequireDefault(_App);                                                                           //\n                                                                                                                    //\nvar _ChatBox = require('../imports/ui/ChatBox.jsx');                                                                // 8\n                                                                                                                    //\nvar _ChatBox2 = _interopRequireDefault(_ChatBox);                                                                   //\n                                                                                                                    //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                   //\n                                                                                                                    //\n_meteor.Meteor.startup(function () {                                                                                // 10\n  (0, _reactDom.render)(_react2['default'].createElement(                                                           // 11\n    _reactRouter.Router,                                                                                            //\n    { history: _reactRouter.browserHistory },                                                                       //\n    _react2['default'].createElement(_reactRouter.Route, { path: '/', component: _App2['default'] }),               //\n    _react2['default'].createElement(_reactRouter.Route, { path: '/:friendId', component: _ChatBox2['default'] })   //\n  ), document.getElementById('app'));                                                                               //\n});                                                                                                                 //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"imports\":{\"api\":{\"msgs.js\":[\"meteor/meteor\",\"meteor/mongo\",\"meteor/check\",function(require,exports){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/api/msgs.js                                                                                              //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nexports.__esModule = true;                                                                                          //\nexports.Msgs = undefined;                                                                                           //\n                                                                                                                    //\nvar _meteor = require('meteor/meteor');                                                                             // 1\n                                                                                                                    //\nvar _mongo = require('meteor/mongo');                                                                               // 2\n                                                                                                                    //\nvar _check = require('meteor/check');                                                                               // 3\n                                                                                                                    //\nvar Msgs = exports.Msgs = new _mongo.Mongo.Collection('msgs');                                                      // 5\nif (_meteor.Meteor.isServer) {                                                                                      // 6\n  _meteor.Meteor.publish('msgs', function () {                                                                      // 7\n    function msgsPublication() {                                                                                    // 7\n      return Msgs.find({                                                                                            // 8\n        $or: [{ 'sender.id': this.userId }, { 'recevier.id': this.userId }]                                         // 9\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return msgsPublication;                                                                                         //\n  }());                                                                                                             //\n  _meteor.Meteor.publish('chatMsgs', function () {                                                                  // 15\n    function chatMsgsPublication(friend_id) {                                                                       // 15\n      console.log(friend_id, 'asdsadsdsadasdas');                                                                   // 16\n      return Msgs.find({                                                                                            // 17\n        $or: [{ 'sender.id': this.userId, 'recevier.id': friend_id }, { 'sender.id': friend_id, 'recevier.id': this.userId }]\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return chatMsgsPublication;                                                                                     //\n  }());                                                                                                             //\n}                                                                                                                   //\n                                                                                                                    //\n_meteor.Meteor.methods({                                                                                            // 26\n  'msgs.insert': function () {                                                                                      // 27\n    function msgsInsert(text, friend) {                                                                             //\n      (0, _check.check)(text, String);                                                                              // 28\n                                                                                                                    //\n      if (!_meteor.Meteor.userId()) {                                                                               // 30\n        throw new _meteor.Meteor.Error('not-authorized');                                                           // 31\n      }                                                                                                             //\n                                                                                                                    //\n      Msgs.insert({                                                                                                 // 34\n        sender: {                                                                                                   // 35\n          id: _meteor.Meteor.userId(),                                                                              // 36\n          name: _meteor.Meteor.user().username                                                                      // 37\n        },                                                                                                          //\n        recevier: friend,                                                                                           // 39\n        content: text,                                                                                              // 40\n        time: new Date(),                                                                                           // 41\n        isUnread: true                                                                                              // 42\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return msgsInsert;                                                                                              //\n  }(),                                                                                                              //\n  'msgs.setUnread': function () {                                                                                   // 45\n    function msgsSetUnread(_id) {                                                                                   //\n      (0, _check.check)(_id, String);                                                                               // 46\n      if (!_meteor.Meteor.userId()) {                                                                               // 47\n        throw new _meteor.Meteor.Error('not-authorized');                                                           // 48\n      }                                                                                                             //\n      Msgs.update(_id, { $set: { isUnread: false } });                                                              // 50\n    }                                                                                                               //\n                                                                                                                    //\n    return msgsSetUnread;                                                                                           //\n  }()                                                                                                               //\n});                                                                                                                 //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"startup\":{\"accounts-config.js\":[\"meteor/accounts-base\",function(require){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/startup/accounts-config.js                                                                               //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nvar _accountsBase = require('meteor/accounts-base');                                                                // 1\n                                                                                                                    //\n_accountsBase.Accounts.ui.config({                                                                                  // 3\n  passwordSignupFields: 'USERNAME_ONLY'                                                                             // 4\n});                                                                                                                 //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]},\"ui\":{\"AccountsUIWrapper.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"react-dom\",\"meteor/templating\",\"meteor/blaze\",function(require,exports){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/ui/AccountsUIWrapper.jsx                                                                                 //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nexports.__esModule = true;                                                                                          //\n                                                                                                                    //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                             //\n                                                                                                                    //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                    //\n                                                                                                                    //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                       //\n                                                                                                                    //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                              //\n                                                                                                                    //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                         //\n                                                                                                                    //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                                //\n                                                                                                                    //\nvar _react = require('react');                                                                                      // 1\n                                                                                                                    //\nvar _react2 = _interopRequireDefault(_react);                                                                       //\n                                                                                                                    //\nvar _reactDom = require('react-dom');                                                                               // 2\n                                                                                                                    //\nvar _reactDom2 = _interopRequireDefault(_reactDom);                                                                 //\n                                                                                                                    //\nvar _templating = require('meteor/templating');                                                                     // 3\n                                                                                                                    //\nvar _blaze = require('meteor/blaze');                                                                               // 4\n                                                                                                                    //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                   //\n                                                                                                                    //\nvar AccountsUIWrapper = function (_Component) {                                                                     //\n  (0, _inherits3['default'])(AccountsUIWrapper, _Component);                                                        //\n                                                                                                                    //\n  function AccountsUIWrapper() {                                                                                    //\n    (0, _classCallCheck3['default'])(this, AccountsUIWrapper);                                                      //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                    //\n  }                                                                                                                 //\n                                                                                                                    //\n  AccountsUIWrapper.prototype.componentDidMount = function () {                                                     //\n    function componentDidMount() {                                                                                  //\n      // Use Meteor Blaze to render login buttons                                                                   //\n      this.view = _blaze.Blaze.render(_templating.Template.loginButtons, _reactDom2['default'].findDOMNode(this.refs.container));\n    }                                                                                                               //\n                                                                                                                    //\n    return componentDidMount;                                                                                       //\n  }();                                                                                                              //\n                                                                                                                    //\n  AccountsUIWrapper.prototype.componentWillUnmount = function () {                                                  // 6\n    function componentWillUnmount() {                                                                               //\n      // Clean up Blaze view                                                                                        //\n      _blaze.Blaze.remove(this.view);                                                                               // 14\n    }                                                                                                               //\n                                                                                                                    //\n    return componentWillUnmount;                                                                                    //\n  }();                                                                                                              //\n                                                                                                                    //\n  AccountsUIWrapper.prototype.render = function () {                                                                // 6\n    function render() {                                                                                             //\n      // Just render a placeholder container that will be filled in                                                 //\n      return _react2['default'].createElement('span', { ref: 'container' });                                        // 18\n    }                                                                                                               //\n                                                                                                                    //\n    return render;                                                                                                  //\n  }();                                                                                                              //\n                                                                                                                    //\n  return AccountsUIWrapper;                                                                                         //\n}(_react.Component);                                                                                                //\n                                                                                                                    //\nexports['default'] = AccountsUIWrapper;                                                                             //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"App.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/meteor\",\"meteor/react-meteor-data\",\"../api/msgs.js\",\"./MsgBox.jsx\",\"./AccountsUIWrapper.jsx\",function(require,exports){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/ui/App.jsx                                                                                               //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nexports.__esModule = true;                                                                                          //\n                                                                                                                    //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                             //\n                                                                                                                    //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                    //\n                                                                                                                    //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                       //\n                                                                                                                    //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                              //\n                                                                                                                    //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                         //\n                                                                                                                    //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                                //\n                                                                                                                    //\nvar _react = require('react');                                                                                      // 1\n                                                                                                                    //\nvar _react2 = _interopRequireDefault(_react);                                                                       //\n                                                                                                                    //\nvar _meteor = require('meteor/meteor');                                                                             // 2\n                                                                                                                    //\nvar _reactMeteorData = require('meteor/react-meteor-data');                                                         // 3\n                                                                                                                    //\nvar _msgs = require('../api/msgs.js');                                                                              // 4\n                                                                                                                    //\nvar _MsgBox = require('./MsgBox.jsx');                                                                              // 5\n                                                                                                                    //\nvar _MsgBox2 = _interopRequireDefault(_MsgBox);                                                                     //\n                                                                                                                    //\nvar _AccountsUIWrapper = require('./AccountsUIWrapper.jsx');                                                        // 6\n                                                                                                                    //\nvar _AccountsUIWrapper2 = _interopRequireDefault(_AccountsUIWrapper);                                               //\n                                                                                                                    //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                   //\n                                                                                                                    //\nvar App = function (_Component) {                                                                                   //\n  (0, _inherits3['default'])(App, _Component);                                                                      //\n                                                                                                                    //\n  function App() {                                                                                                  //\n    (0, _classCallCheck3['default'])(this, App);                                                                    //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                    //\n  }                                                                                                                 //\n                                                                                                                    //\n  App.prototype.concatMsgs = function () {                                                                          //\n    function concatMsgs(msgs) {                                                                                     //\n      var _this2 = this;                                                                                            //\n                                                                                                                    //\n      var fList = [];                                                                                               // 10\n      var result = [];                                                                                              // 11\n      msgs.forEach(function (msg) {                                                                                 // 12\n        var friend_id = msg.sender.id == _this2.props.currentUser._id ? msg.recevier.id : msg.sender.id;            // 13\n        if (fList.indexOf(friend_id) < 0) {                                                                         // 14\n          fList.push(friend_id);                                                                                    // 15\n          result.push(msg);                                                                                         // 16\n        }                                                                                                           //\n      });                                                                                                           //\n      return result;                                                                                                // 19\n    }                                                                                                               //\n                                                                                                                    //\n    return concatMsgs;                                                                                              //\n  }();                                                                                                              //\n                                                                                                                    //\n  App.prototype.render = function () {                                                                              // 7\n    function render() {                                                                                             //\n      return _react2['default'].createElement(                                                                      // 23\n        'div',                                                                                                      //\n        { className: 'page-wrap' },                                                                                 //\n        _react2['default'].createElement(_AccountsUIWrapper2['default'], null),                                     //\n        _react2['default'].createElement(_MsgBox2['default'], { msgs: this.concatMsgs(this.props.msgs) })           //\n      );                                                                                                            //\n    }                                                                                                               //\n                                                                                                                    //\n    return render;                                                                                                  //\n  }();                                                                                                              //\n                                                                                                                    //\n  return App;                                                                                                       //\n}(_react.Component);                                                                                                //\n                                                                                                                    //\nApp.propTypes = {                                                                                                   // 32\n  msgs: _react.PropTypes.array.isRequired,                                                                          // 33\n  currentUser: _react.PropTypes.object                                                                              // 34\n};                                                                                                                  //\n                                                                                                                    //\nexports['default'] = (0, _reactMeteorData.createContainer)(function () {                                            //\n  _meteor.Meteor.subscribe('msgs');                                                                                 // 38\n  return {                                                                                                          // 39\n    msgs: _msgs.Msgs.find({}, { sort: { time: -1 } }).fetch(),                                                      // 40\n    currentUser: _meteor.Meteor.user()                                                                              // 41\n  };                                                                                                                //\n}, App);                                                                                                            //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"ChatBox.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/react-meteor-data\",\"react-dom\",\"meteor/meteor\",\"./ChatBoxItem.jsx\",\"../api/msgs.js\",\"react-router\",function(require,exports){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/ui/ChatBox.jsx                                                                                           //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nexports.__esModule = true;                                                                                          //\n                                                                                                                    //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                             //\n                                                                                                                    //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                    //\n                                                                                                                    //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                       //\n                                                                                                                    //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                              //\n                                                                                                                    //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                         //\n                                                                                                                    //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                                //\n                                                                                                                    //\nvar _this2 = this;                                                                                                  //\n                                                                                                                    //\nvar _react = require('react');                                                                                      // 1\n                                                                                                                    //\nvar _react2 = _interopRequireDefault(_react);                                                                       //\n                                                                                                                    //\nvar _reactMeteorData = require('meteor/react-meteor-data');                                                         // 2\n                                                                                                                    //\nvar _reactDom = require('react-dom');                                                                               // 3\n                                                                                                                    //\nvar _reactDom2 = _interopRequireDefault(_reactDom);                                                                 //\n                                                                                                                    //\nvar _meteor = require('meteor/meteor');                                                                             // 4\n                                                                                                                    //\nvar _ChatBoxItem = require('./ChatBoxItem.jsx');                                                                    // 5\n                                                                                                                    //\nvar _ChatBoxItem2 = _interopRequireDefault(_ChatBoxItem);                                                           //\n                                                                                                                    //\nvar _msgs = require('../api/msgs.js');                                                                              // 6\n                                                                                                                    //\nvar _reactRouter = require('react-router');                                                                         // 7\n                                                                                                                    //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }                     //\n                                                                                                                    //\nvar ChatBox = function (_Component) {                                                                               //\n  (0, _inherits3['default'])(ChatBox, _Component);                                                                  //\n                                                                                                                    //\n  function ChatBox() {                                                                                              //\n    (0, _classCallCheck3['default'])(this, ChatBox);                                                                //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                    //\n  }                                                                                                                 //\n                                                                                                                    //\n  ChatBox.prototype.renderChatList = function () {                                                                  //\n    function renderChatList() {                                                                                     //\n      var msgs = this.props.msgs;                                                                                   // 11\n      var friend_name = msgs[0].sender.name == _meteor.Meteor.user().username ? msgs[0].recevier.name : msgs[0].sender.name;\n      return msgs.map(function (msg) {                                                                              // 13\n        return _react2['default'].createElement(_ChatBoxItem2['default'], {                                         // 14\n          key: msg._id,                                                                                             // 16\n          msg: msg,                                                                                                 // 17\n          friendName: friend_name                                                                                   // 18\n        });                                                                                                         //\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return renderChatList;                                                                                          //\n  }();                                                                                                              //\n                                                                                                                    //\n  ChatBox.prototype.handleSubmit = function () {                                                                    // 9\n    function handleSubmit(event) {                                                                                  //\n      event.preventDefault();                                                                                       // 25\n      var text = _reactDom2['default'].findDOMNode(this.refs.textInput).value.trim();                               // 26\n      if (text) {                                                                                                   // 27\n        var _msg = this.props.msgs[0];                                                                              // 28\n        var friend = {                                                                                              // 29\n          id: _msg.sender.id === _meteor.Meteor.userId() ? _msg.recevier.id : _msg.sender.id,                       // 30\n          name: _msg.sender.name == _meteor.Meteor.user().username ? _msg.recevier.name : _msg.sender.name          // 31\n        };                                                                                                          //\n        _meteor.Meteor.call('msgs.insert', text, friend);                                                           // 33\n        _reactDom2['default'].findDOMNode(this.refs.textInput).value = '';                                          // 34\n        var list = _reactDom2['default'].findDOMNode(this.refs.list);                                               // 35\n        list.scrollTop = list.scrollHeight;                                                                         // 36\n      }                                                                                                             //\n    }                                                                                                               //\n                                                                                                                    //\n    return handleSubmit;                                                                                            //\n  }();                                                                                                              //\n                                                                                                                    //\n  ChatBox.prototype.render = function () {                                                                          // 9\n    function render() {                                                                                             //\n      var msgs = this.props.msgs;                                                                                   // 41\n      var friend_name = msgs[0].sender.name == _meteor.Meteor.user().username ? msgs[0].recevier.name : msgs[0].sender.name;\n      return _react2['default'].createElement(                                                                      // 43\n        'div',                                                                                                      //\n        { className: 'chat-box page' },                                                                             //\n        _react2['default'].createElement(                                                                           //\n          'h1',                                                                                                     //\n          { className: 'page-title' },                                                                              //\n          _react2['default'].createElement(                                                                         //\n            _reactRouter.Link,                                                                                      //\n            { className: 'page-title_back', to: '/' },                                                              //\n            '<'                                                                                                     //\n          ),                                                                                                        //\n          friend_name                                                                                               //\n        ),                                                                                                          //\n        _react2['default'].createElement(                                                                           //\n          'ul',                                                                                                     //\n          { ref: 'list', className: 'chat-box_list' },                                                              //\n          this.renderChatList()                                                                                     //\n        ),                                                                                                          //\n        _react2['default'].createElement(                                                                           //\n          'form',                                                                                                   //\n          { className: 'chat-box_msg', onSubmit: this.handleSubmit.bind(this) },                                    //\n          _react2['default'].createElement('input', { className: 'chat-box_input', type: 'text', ref: 'textInput', placeholder: 'Type to send a messsage' })\n        )                                                                                                           //\n      );                                                                                                            //\n    }                                                                                                               //\n                                                                                                                    //\n    return render;                                                                                                  //\n  }();                                                                                                              //\n                                                                                                                    //\n  return ChatBox;                                                                                                   //\n}(_react.Component);                                                                                                //\n                                                                                                                    //\nChatBox.propTypes = {                                                                                               // 61\n  msgs: _react.PropTypes.array.isRequired                                                                           // 62\n};                                                                                                                  //\n                                                                                                                    //\nexports['default'] = (0, _reactMeteorData.createContainer)(function () {                                            //\n  var user_id = _meteor.Meteor.userId();                                                                            // 66\n  // TODO  == Don't know how to get friend_id from component's props ==                                             //\n  var friend_id = _this2.location.pathname.slice(1);                                                                // 65\n  _meteor.Meteor.subscribe('chatMsgs', friend_id);                                                                  // 69\n  return {                                                                                                          // 70\n    msgs: _msgs.Msgs.find({                                                                                         // 71\n      $or: [{ 'sender.id': user_id, 'recevier.id': friend_id }, { 'sender.id': friend_id, 'recevier.id': user_id }]\n    }).fetch()                                                                                                      //\n  };                                                                                                                //\n}, ChatBox);                                                                                                        //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"ChatBoxItem.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/meteor\",function(require,exports){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/ui/ChatBoxItem.jsx                                                                                       //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nexports.__esModule = true;                                                                                          //\n                                                                                                                    //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                             //\n                                                                                                                    //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                    //\n                                                                                                                    //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                       //\n                                                                                                                    //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                              //\n                                                                                                                    //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                         //\n                                                                                                                    //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                                //\n                                                                                                                    //\nvar _react = require('react');                                                                                      // 1\n                                                                                                                    //\nvar _react2 = _interopRequireDefault(_react);                                                                       //\n                                                                                                                    //\nvar _meteor = require('meteor/meteor');                                                                             // 2\n                                                                                                                    //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                   //\n                                                                                                                    //\nvar ChatBoxItem = function (_Component) {                                                                           //\n  (0, _inherits3['default'])(ChatBoxItem, _Component);                                                              //\n                                                                                                                    //\n  function ChatBoxItem() {                                                                                          //\n    (0, _classCallCheck3['default'])(this, ChatBoxItem);                                                            //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                    //\n  }                                                                                                                 //\n                                                                                                                    //\n  ChatBoxItem.prototype.render = function () {                                                                      //\n    function render() {                                                                                             //\n      var msg = this.props.msg;                                                                                     // 7\n      var friendName = this.props.msg.sender.id === _meteor.Meteor.userId() ? _meteor.Meteor.user().username : this.props.friendName;\n      return _react2['default'].createElement(                                                                      // 9\n        'li',                                                                                                       //\n        { className: 'chat-item' },                                                                                 //\n        _react2['default'].createElement(                                                                           //\n          'div',                                                                                                    //\n          { className: 'chat-item_info' },                                                                          //\n          _react2['default'].createElement(                                                                         //\n            'span',                                                                                                 //\n            { className: 'name' },                                                                                  //\n            friendName,                                                                                             //\n            ' :'                                                                                                    //\n          ),                                                                                                        //\n          _react2['default'].createElement(                                                                         //\n            'span',                                                                                                 //\n            { className: 'time' },                                                                                  //\n            msg.time.toLocaleDateString() + '  ' + msg.time.toLocaleTimeString()                                    //\n          )                                                                                                         //\n        ),                                                                                                          //\n        _react2['default'].createElement(                                                                           //\n          'p',                                                                                                      //\n          { className: 'chat-item_content' },                                                                       //\n          msg.content                                                                                               //\n        )                                                                                                           //\n      );                                                                                                            //\n    }                                                                                                               //\n                                                                                                                    //\n    return render;                                                                                                  //\n  }();                                                                                                              //\n                                                                                                                    //\n  return ChatBoxItem;                                                                                               //\n}(_react.Component);                                                                                                //\n                                                                                                                    //\nexports['default'] = ChatBoxItem;                                                                                   //\n                                                                                                                    //\n                                                                                                                    //\nChatBoxItem.propTypes = {                                                                                           // 21\n  msg: _react.PropTypes.object.isRequired,                                                                          // 22\n  friendName: _react.PropTypes.string.isRequired                                                                    // 23\n};                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"MsgBox.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/meteor\",\"./MsgBoxItem.jsx\",function(require,exports){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/ui/MsgBox.jsx                                                                                            //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nexports.__esModule = true;                                                                                          //\n                                                                                                                    //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                             //\n                                                                                                                    //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                    //\n                                                                                                                    //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                       //\n                                                                                                                    //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                              //\n                                                                                                                    //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                         //\n                                                                                                                    //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                                //\n                                                                                                                    //\nvar _react = require('react');                                                                                      // 1\n                                                                                                                    //\nvar _react2 = _interopRequireDefault(_react);                                                                       //\n                                                                                                                    //\nvar _meteor = require('meteor/meteor');                                                                             // 2\n                                                                                                                    //\nvar _MsgBoxItem = require('./MsgBoxItem.jsx');                                                                      // 3\n                                                                                                                    //\nvar _MsgBoxItem2 = _interopRequireDefault(_MsgBoxItem);                                                             //\n                                                                                                                    //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                   //\n                                                                                                                    //\n// MsgBox component - represents user's msg list                                                                    //\n                                                                                                                    //\nvar MsgBox = function (_Component) {                                                                                //\n  (0, _inherits3['default'])(MsgBox, _Component);                                                                   //\n                                                                                                                    //\n  function MsgBox() {                                                                                               //\n    (0, _classCallCheck3['default'])(this, MsgBox);                                                                 //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                    //\n  }                                                                                                                 //\n                                                                                                                    //\n  MsgBox.prototype.renderMsgList = function () {                                                                    //\n    function renderMsgList() {                                                                                      //\n      var msgs = this.props.msgs;                                                                                   // 7\n      return msgs.map(function (msg) {                                                                              // 8\n        return _react2['default'].createElement(_MsgBoxItem2['default'], {                                          // 9\n          key: msg._id,                                                                                             // 11\n          msg: msg                                                                                                  // 12\n        });                                                                                                         //\n      });                                                                                                           //\n    }                                                                                                               //\n                                                                                                                    //\n    return renderMsgList;                                                                                           //\n  }();                                                                                                              //\n                                                                                                                    //\n  MsgBox.prototype.unreadMsgCount = function () {                                                                   // 5\n    function unreadMsgCount() {                                                                                     //\n      var msgs = this.props.msgs;                                                                                   // 18\n      var count = 0;                                                                                                // 19\n      msgs.forEach(function (msg) {                                                                                 // 20\n        return msg.isUnread && count++;                                                                             //\n      });                                                                                                           //\n      return count;                                                                                                 // 21\n    }                                                                                                               //\n                                                                                                                    //\n    return unreadMsgCount;                                                                                          //\n  }();                                                                                                              //\n                                                                                                                    //\n  MsgBox.prototype.render = function () {                                                                           // 5\n    function render() {                                                                                             //\n      return _react2['default'].createElement(                                                                      // 24\n        'div',                                                                                                      //\n        { className: 'page msg-box' },                                                                              //\n        _react2['default'].createElement(                                                                           //\n          'h1',                                                                                                     //\n          { className: 'page-title' },                                                                              //\n          'My Messages',                                                                                            //\n          _react2['default'].createElement(                                                                         //\n            'div',                                                                                                  //\n            { className: 'page-title_msg-count' },                                                                  //\n            _react2['default'].createElement(                                                                       //\n              'span',                                                                                               //\n              { className: 'page-title_msg-count--unread' },                                                        //\n              ' ',                                                                                                  //\n              this.unreadMsgCount(),                                                                                //\n              ' '                                                                                                   //\n            ),                                                                                                      //\n            ' / ',                                                                                                  //\n            this.props.msgs.length                                                                                  //\n          )                                                                                                         //\n        ),                                                                                                          //\n        _react2['default'].createElement(                                                                           //\n          'ul',                                                                                                     //\n          { className: 'msg-list' },                                                                                //\n          this.renderMsgList()                                                                                      //\n        )                                                                                                           //\n      );                                                                                                            //\n    }                                                                                                               //\n                                                                                                                    //\n    return render;                                                                                                  //\n  }();                                                                                                              //\n                                                                                                                    //\n  return MsgBox;                                                                                                    //\n}(_react.Component);                                                                                                //\n                                                                                                                    //\nexports['default'] = MsgBox;                                                                                        //\n                                                                                                                    //\n                                                                                                                    //\nMsgBox.propTypes = {                                                                                                // 40\n  msgs: _react.PropTypes.array.isRequired                                                                           // 41\n};                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}],\"MsgBoxItem.jsx\":[\"babel-runtime/helpers/classCallCheck\",\"babel-runtime/helpers/possibleConstructorReturn\",\"babel-runtime/helpers/inherits\",\"react\",\"meteor/meteor\",\"classnames\",\"react-router\",function(require,exports){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                                  //\n// imports/ui/MsgBoxItem.jsx                                                                                        //\n//                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                                    //\nexports.__esModule = true;                                                                                          //\n                                                                                                                    //\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');                                             //\n                                                                                                                    //\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);                                                    //\n                                                                                                                    //\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');                       //\n                                                                                                                    //\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);                              //\n                                                                                                                    //\nvar _inherits2 = require('babel-runtime/helpers/inherits');                                                         //\n                                                                                                                    //\nvar _inherits3 = _interopRequireDefault(_inherits2);                                                                //\n                                                                                                                    //\nvar _react = require('react');                                                                                      // 1\n                                                                                                                    //\nvar _react2 = _interopRequireDefault(_react);                                                                       //\n                                                                                                                    //\nvar _meteor = require('meteor/meteor');                                                                             // 2\n                                                                                                                    //\nvar _classnames = require('classnames');                                                                            // 3\n                                                                                                                    //\nvar _classnames2 = _interopRequireDefault(_classnames);                                                             //\n                                                                                                                    //\nvar _reactRouter = require('react-router');                                                                         // 4\n                                                                                                                    //\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }                   //\n                                                                                                                    //\nvar MsgBoxItem = function (_Component) {                                                                            //\n  (0, _inherits3['default'])(MsgBoxItem, _Component);                                                               //\n                                                                                                                    //\n  function MsgBoxItem() {                                                                                           //\n    (0, _classCallCheck3['default'])(this, MsgBoxItem);                                                             //\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));                    //\n  }                                                                                                                 //\n                                                                                                                    //\n  MsgBoxItem.prototype.readThisMsg = function () {                                                                  //\n    function readThisMsg() {                                                                                        //\n      var _id = this.props.msg._id;                                                                                 // 10\n      if (this.props.msg.isUnread) {                                                                                // 11\n        _meteor.Meteor.call('msgs.setUnread', _id);                                                                 // 12\n      }                                                                                                             //\n    }                                                                                                               //\n                                                                                                                    //\n    return readThisMsg;                                                                                             //\n  }();                                                                                                              //\n                                                                                                                    //\n  MsgBoxItem.prototype.render = function () {                                                                       // 7\n    function render() {                                                                                             //\n      var msg = this.props.msg;                                                                                     // 17\n      var friend_id = msg.sender.id == _meteor.Meteor.userId() ? msg.recevier.id : msg.sender.id;                   // 18\n      console.log(_meteor.Meteor.user(), ' is my name! <=======>');                                                 // 19\n      var friend_name = msg.sender.name == _meteor.Meteor.user().username ? msg.recevier.name : msg.sender.name;    // 20\n      var itemClassName = (0, _classnames2['default'])({                                                            // 21\n        'msg-item': true,                                                                                           // 22\n        'msg-item--unread': msg.isUnread                                                                            // 23\n      });                                                                                                           //\n      return _react2['default'].createElement(                                                                      // 25\n        'li',                                                                                                       //\n        { className: itemClassName },                                                                               //\n        _react2['default'].createElement(                                                                           //\n          _reactRouter.Link,                                                                                        //\n          { to: '/' + friend_id, onClick: this.readThisMsg.bind(this) },                                            //\n          _react2['default'].createElement(                                                                         //\n            'div',                                                                                                  //\n            { className: 'msg-item_name' },                                                                         //\n            ' ',                                                                                                    //\n            friend_name,                                                                                            //\n            ' '                                                                                                     //\n          ),                                                                                                        //\n          _react2['default'].createElement(                                                                         //\n            'div',                                                                                                  //\n            { className: 'msg-item_content' },                                                                      //\n            _react2['default'].createElement(                                                                       //\n              'span',                                                                                               //\n              { className: 'msg-item_time' },                                                                       //\n              ' ',                                                                                                  //\n              msg.time.toLocaleDateString() + '  ' + msg.time.toLocaleTimeString()                                  //\n            ),                                                                                                      //\n            _react2['default'].createElement(                                                                       //\n              'p',                                                                                                  //\n              null,                                                                                                 //\n              msg.content,                                                                                          //\n              ' '                                                                                                   //\n            )                                                                                                       //\n          )                                                                                                         //\n        )                                                                                                           //\n      );                                                                                                            //\n    }                                                                                                               //\n                                                                                                                    //\n    return render;                                                                                                  //\n  }();                                                                                                              //\n                                                                                                                    //\n  return MsgBoxItem;                                                                                                //\n}(_react.Component);                                                                                                //\n                                                                                                                    //\nexports['default'] = MsgBoxItem;                                                                                    //\n                                                                                                                    //\n                                                                                                                    //\nMsgBoxItem.propTypes = {                                                                                            // 39\n  msg: _react.PropTypes.object.isRequired                                                                           // 40\n};                                                                                                                  //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}]}}},{\"extensions\":[\".js\",\".json\",\".html\",\".jsx\",\".less\"]});\nrequire(\"./client/main.html\");\nrequire(\"./client/main.jsx\");","servePath":"/app.js","sourceMap":{"version":3,"sources":["/client/main.jsx","/imports/api/msgs.js","/imports/startup/accounts-config.js","/imports/ui/AccountsUIWrapper.jsx","/imports/ui/App.jsx","/imports/ui/ChatBox.jsx","/imports/ui/ChatBoxItem.jsx","/imports/ui/MsgBox.jsx","/imports/ui/MsgBoxItem.jsx"],"names":[],"mappings":"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","file":"/app.js","sourcesContent":["import React from 'react';\nimport { Meteor } from 'meteor/meteor';\nimport { render } from 'react-dom';\nimport { Router, Route, browserHistory } from 'react-router'\n \nimport '../imports/startup/accounts-config.js'\nimport App from '../imports/ui/App.jsx'\nimport ChatBox from '../imports/ui/ChatBox.jsx'\n \nMeteor.startup(() => {\n  render((\n    <Router history={browserHistory}>\n      <Route path=\"/\" component={App} />\n      <Route path=\"/:friendId\" component={ChatBox} />\n    </Router>), document.getElementById('app'))\n});","import { Meteor } from 'meteor/meteor'\nimport { Mongo } from 'meteor/mongo'\nimport { check } from 'meteor/check'\n \nexport const Msgs = new Mongo.Collection('msgs');\nif (Meteor.isServer) {\n  Meteor.publish('msgs', function msgsPublication() {\n    return Msgs.find({\n      $or: [\n        { 'sender.id': this.userId },\n        { 'recevier.id': this.userId },\n      ],\n    })\n  })\n  Meteor.publish('chatMsgs', function chatMsgsPublication(friend_id) {\n    console.log(friend_id,'asdsadsdsadasdas')\n    return Msgs.find({\n      $or: [\n        {'sender.id': this.userId, 'recevier.id': friend_id}, \n        {'sender.id': friend_id, 'recevier.id': this.userId}\n      ] \n    })\n  })\n}\n \nMeteor.methods({\n  'msgs.insert'(text, friend) {\n    check(text, String)\n\n    if (! Meteor.userId()) {\n      throw new Meteor.Error('not-authorized')\n    }\n\n    Msgs.insert({\n      sender: {\n        id: Meteor.userId(),\n        name: Meteor.user().username\n      },\n      recevier: friend,\n      content: text,\n      time: new Date(),\n      isUnread: true\n    })\n  },\n  'msgs.setUnread'(_id) {\n    check(_id, String)\n    if (! Meteor.userId()) {\n      throw new Meteor.Error('not-authorized')\n    }\n    Msgs.update(_id, { $set: { isUnread: false } })\n  }\n})","import { Accounts } from 'meteor/accounts-base';\n \nAccounts.ui.config({\n  passwordSignupFields: 'USERNAME_ONLY',\n});","import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Template } from 'meteor/templating';\nimport { Blaze } from 'meteor/blaze';\n \nexport default class AccountsUIWrapper extends Component {\n  componentDidMount() {\n    // Use Meteor Blaze to render login buttons\n    this.view = Blaze.render(Template.loginButtons,\n      ReactDOM.findDOMNode(this.refs.container));\n  }\n  componentWillUnmount() {\n    // Clean up Blaze view\n    Blaze.remove(this.view);\n  }\n  render() {\n    // Just render a placeholder container that will be filled in\n    return <span ref=\"container\" />;\n  }\n}","import React, { Component, PropTypes } from 'react'\nimport { Meteor } from 'meteor/meteor'\nimport { createContainer } from 'meteor/react-meteor-data'\nimport { Msgs } from '../api/msgs.js'\nimport MsgBox from './MsgBox.jsx'\nimport AccountsUIWrapper from './AccountsUIWrapper.jsx'\nclass App extends Component {\n\n  concatMsgs (msgs) {\n    let fList = []\n    let result = []\n    msgs.forEach((msg) => {\n      let friend_id = msg.sender.id == this.props.currentUser._id ? msg.recevier.id : msg.sender.id\n      if(fList.indexOf(friend_id) < 0) {\n        fList.push(friend_id)\n        result.push(msg)\n      }\n    })\n    return result\n  }\n\n  render() {\n    return (\n      <div className=\"page-wrap\">\n        <AccountsUIWrapper />\n        <MsgBox msgs={ this.concatMsgs(this.props.msgs) }/>\n      </div> \n    );\n  }\n}\n \nApp.propTypes = {\n  msgs: PropTypes.array.isRequired,\n  currentUser: PropTypes.object,\n};\n \nexport default createContainer(() => {\n  Meteor.subscribe('msgs')\n  return {\n    msgs: Msgs.find({}, { sort:{ time :-1} }).fetch(),\n    currentUser: Meteor.user(),\n  };\n}, App);","import React, { Component, PropTypes } from 'react'\nimport { createContainer } from 'meteor/react-meteor-data'\nimport ReactDOM from 'react-dom'\nimport { Meteor } from 'meteor/meteor'\nimport ChatBoxItem from './ChatBoxItem.jsx'\nimport { Msgs } from \"../api/msgs.js\"\nimport { Link } from 'react-router'\n\nclass ChatBox extends Component {\n  renderChatList() {\n    const msgs = this.props.msgs\n    const friend_name = msgs[0].sender.name == Meteor.user().username ? msgs[0].recevier.name : msgs[0].sender.name\n    return msgs.map((msg) => {\n      return (\n        <ChatBoxItem\n         key={msg._id}\n         msg={msg}\n         friendName={friend_name}\n        />\n      )\n    })\n  }\n\n  handleSubmit(event) {\n    event.preventDefault()\n    const text = ReactDOM.findDOMNode(this.refs.textInput).value.trim()\n    if (text) {\n      const _msg = this.props.msgs[0]\n      const friend = {\n        id: _msg.sender.id === Meteor.userId() ? _msg.recevier.id : _msg.sender.id,\n        name: _msg.sender.name == Meteor.user().username ? _msg.recevier.name : _msg.sender.name\n      }\n      Meteor.call('msgs.insert', text, friend)\n      ReactDOM.findDOMNode(this.refs.textInput).value = ''\n      let list = ReactDOM.findDOMNode(this.refs.list)\n      list.scrollTop = list.scrollHeight\n    }\n  }\n\n  render() {\n    const msgs = this.props.msgs\n    const friend_name = msgs[0].sender.name == Meteor.user().username ? msgs[0].recevier.name : msgs[0].sender.name\n    return (\n      <div className=\"chat-box page\">\n        <h1 className=\"page-title\">\n          <Link className=\"page-title_back\" to={'/'}>&lt;</Link>\n          { friend_name }\n        </h1>\n        <ul ref=\"list\" className=\"chat-box_list\">\n          { this.renderChatList() }\n        </ul>\n        <form className=\"chat-box_msg\" onSubmit={this.handleSubmit.bind(this)}>\n          <input className=\"chat-box_input\" type=\"text\" ref=\"textInput\" placeholder=\"Type to send a messsage\"/>\n        </form>\n      </div>\n    )\n  }\n}\n\n\nChatBox.propTypes = {\n  msgs: PropTypes.array.isRequired\n}\n\nexport default createContainer(() => {\n  const user_id = Meteor.userId()\n  // TODO  == Don't know how to get friend_id from component's props ==\n  const friend_id = this.location.pathname.slice(1)\n  Meteor.subscribe('chatMsgs', friend_id)\n  return {\n    msgs: Msgs.find({\n      $or: [\n        {'sender.id': user_id, 'recevier.id': friend_id}, \n        {'sender.id': friend_id, 'recevier.id': user_id}\n      ] \n    }).fetch()\n  }\n}, ChatBox)\n","import React, { Component, PropTypes } from 'react'\nimport { Meteor } from 'meteor/meteor'\n\n\nexport default class ChatBoxItem extends Component {\n  render() {\n    const msg = this.props.msg\n    const friendName = this.props.msg.sender.id === Meteor.userId() ? Meteor.user().username : this.props.friendName\n    return (\n      <li className=\"chat-item\">\n        <div className=\"chat-item_info\">\n          <span className=\"name\">{ friendName } :</span>\n          <span className=\"time\">{ `${msg.time.toLocaleDateString()}  ${msg.time.toLocaleTimeString()}` }</span>\n        </div>\n        <p className=\"chat-item_content\">{ msg.content }</p>\n      </li>\n    )\n  }\n}\n\nChatBoxItem.propTypes = {\n  msg: PropTypes.object.isRequired,\n  friendName: PropTypes.string.isRequired\n}\n\n","import React, { Component, PropTypes } from 'react'\nimport { Meteor } from 'meteor/meteor'\nimport MsgBoxItem from \"./MsgBoxItem.jsx\"\n// MsgBox component - represents user's msg list\nexport default class MsgBox extends Component {\n  renderMsgList () {\n    let msgs = this.props.msgs\n    return msgs.map(msg => {\n      return (\n        <MsgBoxItem\n          key={msg._id}\n          msg={msg}\n        />\n      )\n    })\n  }\n  unreadMsgCount () {\n    const msgs = this.props.msgs\n    let count = 0\n    msgs.forEach(msg => msg.isUnread && count++)\n    return count\n  }\n  render () {\n    return (\n      <div className=\"page msg-box\">\n        <h1 className=\"page-title\">\n          My Messages\n          <div className=\"page-title_msg-count\">\n            <span className=\"page-title_msg-count--unread\"> { this.unreadMsgCount() } </span> / { this.props.msgs.length }\n          </div>\n        </h1>\n        <ul className=\"msg-list\">  \n          { this.renderMsgList() }\n        </ul>\n      </div>\n    )\n  }\n}\n \nMsgBox.propTypes = {\n  msgs: PropTypes.array.isRequired\n}","import React, { Component, PropTypes } from 'react'\nimport { Meteor } from 'meteor/meteor'\nimport classnames from 'classnames'\nimport { Link } from 'react-router'\n\n\nexport default class MsgBoxItem extends Component {\n\n  readThisMsg() {\n    let _id = this.props.msg._id\n    if (this.props.msg.isUnread) {\n      Meteor.call('msgs.setUnread', _id)\n    }\n  }\n\n  render () {\n    const msg = this.props.msg\n    const friend_id = msg.sender.id == Meteor.userId() ? msg.recevier.id : msg.sender.id\n    console.log(Meteor.user(), ' is my name! <=======>')\n    const friend_name = msg.sender.name == Meteor.user().username ? msg.recevier.name : msg.sender.name\n    const itemClassName = classnames({\n      'msg-item': true,\n      'msg-item--unread': msg.isUnread\n    })\n    return (\n      <li className={itemClassName}>\n        <Link to={`/${friend_id}`} onClick={this.readThisMsg.bind(this)}>\n        <div className=\"msg-item_name\"> { friend_name } </div> \n        <div className=\"msg-item_content\"> \n          <span className=\"msg-item_time\"> { `${msg.time.toLocaleDateString()}  ${msg.time.toLocaleTimeString()}` }</span>\n          <p>{ msg.content } </p>\n        </div>  \n        </Link>\n      </li>\n    )\n  }\n}\n \nMsgBoxItem.propTypes = {\n  msg: PropTypes.object.isRequired\n}\n"]}}]