{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default","Component","PropTypes"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"},{"kind":"named","imported":"PropTypes","local":"PropTypes"}]},{"source":"react-dom","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"ReactDOM"}]},{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"classnames","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"classnames"}]},{"source":"../api/users.js","imported":["Users"],"specifiers":[{"kind":"named","imported":"Users","local":"Users"}]},{"source":"react-router","imported":["Link"],"specifiers":[{"kind":"named","imported":"Link","local":"Link"}]}],"exports":{"exported":["MsgBoxItem"],"specifiers":[{"kind":"local","local":"MsgBoxItem","exported":"default"}]}}},"options":{"filename":"/imports/ui/MsgBoxItem.jsx","filenameRelative":"/imports/ui/MsgBoxItem.jsx","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/ui/MsgBoxItem.jsx.map","sourceFileName":"/imports/ui/MsgBoxItem.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"MsgBoxItem"},"ignored":false,"code":"exports.__esModule = true;\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _meteor = require('meteor/meteor');\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _users = require('../api/users.js');\n\nvar _reactRouter = require('react-router');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n// MsgBoxItem component - represents msg item of user's msgBox list\n\nvar MsgBoxItem = function (_Component) {\n  (0, _inherits3['default'])(MsgBoxItem, _Component);\n\n  function MsgBoxItem(props) {\n    (0, _classCallCheck3['default'])(this, MsgBoxItem);\n\n    var _this = (0, _possibleConstructorReturn3['default'])(this, _Component.call(this, props));\n\n    _this.state = {\n      friendName: '',\n      chatMsg: ''\n    };\n    return _this;\n  }\n\n  MsgBoxItem.prototype.getFriendName = function () {\n    function getFriendName(msg) {\n      var _this2 = this;\n\n      var f_id = msg.send_id == _meteor.Meteor.userId() ? msg.recevier_id : msg.send_id;\n      _meteor.Meteor.call('findUser', f_id, function (err, res) {\n        console.log(res);\n        _this2.setState({ friendName: res.username });\n      });\n    }\n\n    return getFriendName;\n  }();\n\n  MsgBoxItem.prototype.componentWillMount = function () {\n    function componentWillMount() {\n      var msg = this.props.msg;\n      var f_id = msg.send_id == _meteor.Meteor.userId() ? msg.recevier_id : msg.send_id;\n      this.getFriendName(this.props.msg);\n    }\n\n    return componentWillMount;\n  }();\n\n  MsgBoxItem.prototype.renderMsg = function () {\n    function renderMsg(msg) {\n      var f_id = msg.send_id == _meteor.Meteor.userId() ? msg.recevier_id : msg.send_id;\n      _meteor.Meteor.call('chatMsg', f_id, function (err, res) {});\n    }\n\n    return renderMsg;\n  }();\n\n  MsgBoxItem.prototype.render = function () {\n    function render() {\n      var msg = this.props.msg;\n      var itemClassName = (0, _classnames2['default'])({\n        'msg-item': true,\n        'msg-item--unread': msg.isUnread\n      });\n      var f_id = msg.send_id == _meteor.Meteor.userId() ? msg.recevier_id : msg.send_id;\n      return _react2['default'].createElement(\n        'li',\n        { className: itemClassName },\n        _react2['default'].createElement(\n          _reactRouter.Link,\n          { to: '/' + f_id },\n          _react2['default'].createElement(\n            'div',\n            { className: 'msg-item-name' },\n            ' ',\n            this.state.friendName,\n            ' '\n          ),\n          _react2['default'].createElement(\n            'div',\n            { className: 'msg-item-content' },\n            _react2['default'].createElement(\n              'span',\n              { className: 'msg-item-time' },\n              ' ',\n              msg.time.toLocaleDateString() + '  ' + msg.time.toLocaleTimeString()\n            ),\n            _react2['default'].createElement(\n              'p',\n              null,\n              msg.content,\n              ' '\n            )\n          ),\n          _react2['default'].createElement(\n            'span',\n            null,\n            this.renderMsg(msg)\n          )\n        )\n      );\n    }\n\n    return render;\n  }();\n\n  return MsgBoxItem;\n}(_react.Component);\n\nexports['default'] = MsgBoxItem;\n\n\nMsgBoxItem.propTypes = {\n  msg: _react.PropTypes.object.isRequired\n};","ast":null,"map":{"version":3,"sources":["/imports/ui/MsgBoxItem.jsx"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AACA;;;;;;IAEqB;;;AACnB,WADmB,UACnB,CAAY,KAAZ,EAAmB;2CADA,YACA;;kEACjB,sBAAM,KAAN,GADiB;;AAEjB,UAAK,KAAL,GAAa;AACX,kBAAY,EAAZ;AACA,eAAS,EAAT;KAFF,CAFiB;;GAAnB;;AADmB,uBASnB;2BAAe,KAAK;;;AAClB,UAAI,OAAO,IAAI,OAAJ,IAAe,eAAO,MAAP,EAAf,GAAiC,IAAI,WAAJ,GAAkB,IAAI,OAAJ,CAD5C;AAElB,qBAAO,IAAP,CAAY,UAAZ,EAAwB,IAAxB,EAA8B,UAAC,GAAD,EAAM,GAAN,EAAc;AAC1C,gBAAQ,GAAR,CAAY,GAAZ,EAD0C;AAE1C,eAAK,QAAL,CAAc,EAAE,YAAY,IAAI,QAAJ,EAA5B,EAF0C;OAAd,CAA9B,CAFkB;;;;;;AATD,uBAiBnB;kCAAsB;AACpB,UAAM,MAAM,KAAK,KAAL,CAAW,GAAX,CADQ;AAEpB,UAAI,OAAO,IAAI,OAAJ,IAAe,eAAO,MAAP,EAAf,GAAiC,IAAI,WAAJ,GAAkB,IAAI,OAAJ,CAF1C;AAGpB,WAAK,aAAL,CAAmB,KAAK,KAAL,CAAW,GAAX,CAAnB,CAHoB;;;;;;AAjBH,uBAuBnB;uBAAW,KAAK;AACd,UAAI,OAAO,IAAI,OAAJ,IAAe,eAAO,MAAP,EAAf,GAAiC,IAAI,WAAJ,GAAkB,IAAI,OAAJ,CADhD;AAEd,qBAAO,IAAP,CAAY,SAAZ,EAAuB,IAAvB,EAA6B,UAAC,GAAD,EAAM,GAAN,EAAc,EAAd,CAA7B,CAFc;;;;;;AAvBG,uBA4BnB;sBAAU;AACR,UAAM,MAAM,KAAK,KAAL,CAAW,GAAX,CADJ;AAER,UAAM,gBAAgB,6BAAW;AAC/B,oBAAY,IAAZ;AACA,4BAAoB,IAAI,QAAJ;OAFA,CAAhB,CAFE;AAMR,UAAI,OAAO,IAAI,OAAJ,IAAe,eAAO,MAAP,EAAf,GAAiC,IAAI,WAAJ,GAAkB,IAAI,OAAJ,CANtD;AAOR,aACE;;UAAI,WAAW,aAAX,EAAJ;QACE;;YAAM,UAAQ,IAAR,EAAN;UACE;;cAAK,WAAU,eAAV,EAAL;;YAAkC,KAAK,KAAL,CAAW,UAAX;eAAlC;WADF;UAEE;;cAAK,WAAU,kBAAV,EAAL;YACE;;gBAAM,WAAU,eAAV,EAAN;;cAAsC,IAAI,IAAJ,CAAS,kBAAT,YAAkC,IAAI,IAAJ,CAAS,kBAAT,EAAxE;aADF;YAEE;;;cAAK,IAAI,OAAJ;iBAAL;aAFF;WAFF;UAME;;;YAAQ,KAAK,SAAL,CAAe,GAAf,CAAR;WANF;SADF;OADF,CAPQ;;;;;;SA5BS;;;;;;AAkDrB,WAAW,SAAX,GAAuB;AACrB,OAAK,iBAAU,MAAV,CAAiB,UAAjB;CADP","file":"/imports/ui/MsgBoxItem.jsx.map","sourcesContent":["import React, { Component, PropTypes } from 'react'\nimport ReactDOM from 'react-dom'\nimport { Meteor } from 'meteor/meteor'\nimport classnames from 'classnames'\nimport { Users } from '../api/users.js'\nimport { Link } from 'react-router'\n// MsgBoxItem component - represents msg item of user's msgBox list\nexport default class MsgBoxItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      friendName: '',\n      chatMsg: ''\n    }\n  }\n\n  getFriendName (msg) {\n    let f_id = msg.send_id == Meteor.userId() ? msg.recevier_id : msg.send_id\n    Meteor.call('findUser', f_id, (err, res) => {\n      console.log(res)\n      this.setState({ friendName: res.username })\n    })\n  }\n\n  componentWillMount () {\n    const msg = this.props.msg\n    let f_id = msg.send_id == Meteor.userId() ? msg.recevier_id : msg.send_id\n    this.getFriendName(this.props.msg)\n  }\n\n  renderMsg (msg) {\n    let f_id = msg.send_id == Meteor.userId() ? msg.recevier_id : msg.send_id\n    Meteor.call('chatMsg', f_id, (err, res) => {\n    })\n  }\n  render () {\n    const msg = this.props.msg\n    const itemClassName = classnames({\n      'msg-item': true,\n      'msg-item--unread': msg.isUnread\n    })\n    let f_id = msg.send_id == Meteor.userId() ? msg.recevier_id : msg.send_id\n    return (\n      <li className={itemClassName}>\n        <Link to={`/${f_id}`}>\n          <div className=\"msg-item-name\"> { this.state.friendName } </div> \n          <div className=\"msg-item-content\"> \n            <span className=\"msg-item-time\"> { `${msg.time.toLocaleDateString()}  ${msg.time.toLocaleTimeString()}` }</span>\n            <p>{ msg.content } </p>\n          </div>\n          <span>{ this.renderMsg(msg) }</span>\n        </Link>\n      </li>\n    )\n  }\n}\n \nMsgBoxItem.propTypes = {\n  msg: PropTypes.object.isRequired\n}"]},"hash":"7e9aacc17f16ff13b44557ddea96a8ac0ba865fb"}
