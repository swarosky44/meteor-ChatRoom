{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"./accounts_common.js","imported":["AccountsCommon"],"specifiers":[{"kind":"named","imported":"AccountsCommon","local":"AccountsCommon"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/accounts-base/accounts_rate_limit.js","filenameRelative":"/packages/accounts-base/accounts_rate_limit.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/accounts-base/accounts_rate_limit.js.map","sourceFileName":"/packages/accounts-base/accounts_rate_limit.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"accounts_rate_limit"},"ignored":false,"code":"var _accounts_common = require('./accounts_common.js');\n\nvar Ap = _accounts_common.AccountsCommon.prototype;\nvar defaultRateLimiterRuleId;\n// Removes default rate limiting rule\nAp.removeDefaultRateLimit = function () {\n  var resp = DDPRateLimiter.removeRule(defaultRateLimiterRuleId);\n  defaultRateLimiterRuleId = null;\n  return resp;\n};\n\n// Add a default rule of limiting logins, creating new users and password reset\n// to 5 times every 10 seconds per connection.\nAp.addDefaultRateLimit = function () {\n  if (!defaultRateLimiterRuleId) {\n    defaultRateLimiterRuleId = DDPRateLimiter.addRule({\n      userId: null,\n      clientAddress: null,\n      type: 'method',\n      name: function () {\n        function name(_name) {\n          return _.contains(['login', 'createUser', 'resetPassword', 'forgotPassword'], _name);\n        }\n\n        return name;\n      }(),\n      connectionId: function () {\n        function connectionId(_connectionId) {\n          return true;\n        }\n\n        return connectionId;\n      }()\n    }, 5, 10000);\n  }\n};\n\nAp.addDefaultRateLimit();","ast":null,"map":{"version":3,"sources":["/packages/accounts-base/accounts_rate_limit.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,KAAK,gCAAe,SAAf;AACT,IAAI,wBAAJ;;AAEA,GAAG,sBAAH,GAA4B,YAAY;AACtC,MAAM,OAAO,eAAe,UAAf,CAA0B,wBAA1B,CAAP,CADgC;AAEtC,6BAA2B,IAA3B,CAFsC;AAGtC,SAAO,IAAP,CAHsC;CAAZ;;;;AAQ5B,GAAG,mBAAH,GAAyB,YAAY;AACnC,MAAI,CAAC,wBAAD,EAA2B;AAC7B,+BAA2B,eAAe,OAAf,CAAuB;AAChD,cAAQ,IAAR;AACA,qBAAe,IAAf;AACA,YAAM,QAAN;AACA;AAAM,sBAAU,KAAV,EAAgB;AACpB,iBAAO,EAAE,QAAF,CAAW,CAAC,OAAD,EAAU,YAAV,EAAwB,eAAxB,EAChB,gBADgB,CAAX,EACc,KADd,CAAP,CADoB;SAAhB;;;SAAN;AAIA;AAAc,8BAAU,aAAV,EAAwB;AACpC,iBAAO,IAAP,CADoC;SAAxB;;;SAAd;KARyB,EAWxB,CAXwB,EAWrB,KAXqB,CAA3B,CAD6B;GAA/B;CADuB;;AAiBzB,GAAG,mBAAH","file":"/packages/accounts-base/accounts_rate_limit.js.map","sourcesContent":["import {AccountsCommon} from \"./accounts_common.js\";\n\nvar Ap = AccountsCommon.prototype;\nvar defaultRateLimiterRuleId;\n// Removes default rate limiting rule\nAp.removeDefaultRateLimit = function () {\n  const resp = DDPRateLimiter.removeRule(defaultRateLimiterRuleId);\n  defaultRateLimiterRuleId = null;\n  return resp;\n};\n\n// Add a default rule of limiting logins, creating new users and password reset\n// to 5 times every 10 seconds per connection.\nAp.addDefaultRateLimit = function () {\n  if (!defaultRateLimiterRuleId) {\n    defaultRateLimiterRuleId = DDPRateLimiter.addRule({\n      userId: null,\n      clientAddress: null,\n      type: 'method',\n      name: function (name) {\n        return _.contains(['login', 'createUser', 'resetPassword',\n          'forgotPassword'], name);\n      },\n      connectionId: function (connectionId) {\n        return true;\n      }\n    }, 5, 10000);\n  }\n};\n\nAp.addDefaultRateLimit();\n"]},"hash":"aaf3d2bac6bd9e3f9201849934b7138e4fb27e15"}
