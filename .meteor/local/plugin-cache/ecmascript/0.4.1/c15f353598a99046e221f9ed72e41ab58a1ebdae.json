{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default","Component","PropTypes"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"},{"kind":"named","imported":"PropTypes","local":"PropTypes"}]},{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/react-meteor-data","imported":["createContainer"],"specifiers":[{"kind":"named","imported":"createContainer","local":"createContainer"}]},{"source":"../api/msgs.js","imported":["Msgs"],"specifiers":[{"kind":"named","imported":"Msgs","local":"Msgs"}]},{"source":"./MsgBox.jsx","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"MsgBox"}]},{"source":"./AccountsUIWrapper.jsx","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"AccountsUIWrapper"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/ui/App.jsx","filenameRelative":"/imports/ui/App.jsx","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/ui/App.jsx.map","sourceFileName":"/imports/ui/App.jsx","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"App"},"ignored":false,"code":"exports.__esModule = true;\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _meteor = require('meteor/meteor');\n\nvar _reactMeteorData = require('meteor/react-meteor-data');\n\nvar _msgs = require('../api/msgs.js');\n\nvar _MsgBox = require('./MsgBox.jsx');\n\nvar _MsgBox2 = _interopRequireDefault(_MsgBox);\n\nvar _AccountsUIWrapper = require('./AccountsUIWrapper.jsx');\n\nvar _AccountsUIWrapper2 = _interopRequireDefault(_AccountsUIWrapper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar App = function (_Component) {\n  (0, _inherits3['default'])(App, _Component);\n\n  function App() {\n    (0, _classCallCheck3['default'])(this, App);\n    return (0, _possibleConstructorReturn3['default'])(this, _Component.apply(this, arguments));\n  }\n\n  App.prototype.concatMsgs = function () {\n    function concatMsgs(msgs) {\n      var _this2 = this;\n\n      var fList = [];\n      var result = [];\n      msgs.forEach(function (msg) {\n        var friend_id = msg.sender.id == _this2.props.currentUser._id ? msg.recevier.id : msg.sender.id;\n        if (fList.indexOf(friend_id) < 0) {\n          fList.push(friend_id);\n          result.push(msg);\n        }\n      });\n      return result;\n    }\n\n    return concatMsgs;\n  }();\n\n  App.prototype.render = function () {\n    function render() {\n      return _react2['default'].createElement(\n        'div',\n        { className: 'page-wrap' },\n        _react2['default'].createElement(_AccountsUIWrapper2['default'], null),\n        _react2['default'].createElement(_MsgBox2['default'], { msgs: this.concatMsgs(this.props.msgs) })\n      );\n    }\n\n    return render;\n  }();\n\n  return App;\n}(_react.Component);\n\nApp.propTypes = {\n  msgs: _react.PropTypes.array.isRequired,\n  currentUser: _react.PropTypes.object\n};\n\nexports['default'] = (0, _reactMeteorData.createContainer)(function () {\n  _meteor.Meteor.subscribe('msgs');\n  return {\n    msgs: _msgs.Msgs.find({}, { sort: { time: -1 } }).fetch(),\n    currentUser: _meteor.Meteor.user()\n  };\n}, App);","ast":null,"map":{"version":3,"sources":["/imports/ui/App.jsx"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;;;IACM;;;;;;;;gBAEJ;wBAAY,MAAM;;;AAChB,UAAI,QAAQ,EAAR,CADY;AAEhB,UAAI,SAAS,EAAT,CAFY;AAGhB,WAAK,OAAL,CAAa,UAAC,GAAD,EAAS;AACpB,YAAI,YAAY,IAAI,MAAJ,CAAW,EAAX,IAAiB,OAAK,KAAL,CAAW,WAAX,CAAuB,GAAvB,GAA6B,IAAI,QAAJ,CAAa,EAAb,GAAkB,IAAI,MAAJ,CAAW,EAAX,CAD5D;AAEpB,YAAG,MAAM,OAAN,CAAc,SAAd,IAA2B,CAA3B,EAA8B;AAC/B,gBAAM,IAAN,CAAW,SAAX,EAD+B;AAE/B,iBAAO,IAAP,CAAY,GAAZ,EAF+B;SAAjC;OAFW,CAAb,CAHgB;AAUhB,aAAO,MAAP,CAVgB;;;;;;AAFd,gBAeJ;sBAAS;AACP,aACE;;UAAK,WAAU,WAAV,EAAL;QACE,sEADF;QAEE,wDAAQ,MAAO,KAAK,UAAL,CAAgB,KAAK,KAAL,CAAW,IAAX,CAAvB,EAAR,CAFF;OADF,CADO;;;;;;SAfL;;;AAyBN,IAAI,SAAJ,GAAgB;AACd,QAAM,iBAAU,KAAV,CAAgB,UAAhB;AACN,eAAa,iBAAU,MAAV;CAFf;;qBAKe,sCAAgB,YAAM;AACnC,iBAAO,SAAP,CAAiB,MAAjB,EADmC;AAEnC,SAAO;AACL,UAAM,WAAK,IAAL,CAAU,EAAV,EAAc,EAAE,MAAK,EAAE,MAAM,CAAC,CAAD,EAAb,EAAhB,EAAoC,KAApC,EAAN;AACA,iBAAa,eAAO,IAAP,EAAb;GAFF,CAFmC;CAAN,EAM5B,GANY","file":"/imports/ui/App.jsx.map","sourcesContent":["import React, { Component, PropTypes } from 'react'\nimport { Meteor } from 'meteor/meteor'\nimport { createContainer } from 'meteor/react-meteor-data'\nimport { Msgs } from '../api/msgs.js'\nimport MsgBox from './MsgBox.jsx'\nimport AccountsUIWrapper from './AccountsUIWrapper.jsx'\nclass App extends Component {\n\n  concatMsgs (msgs) {\n    let fList = []\n    let result = []\n    msgs.forEach((msg) => {\n      let friend_id = msg.sender.id == this.props.currentUser._id ? msg.recevier.id : msg.sender.id\n      if(fList.indexOf(friend_id) < 0) {\n        fList.push(friend_id)\n        result.push(msg)\n      }\n    })\n    return result\n  }\n\n  render() {\n    return (\n      <div className=\"page-wrap\">\n        <AccountsUIWrapper />\n        <MsgBox msgs={ this.concatMsgs(this.props.msgs) }/>\n      </div> \n    );\n  }\n}\n \nApp.propTypes = {\n  msgs: PropTypes.array.isRequired,\n  currentUser: PropTypes.object,\n};\n \nexport default createContainer(() => {\n  Meteor.subscribe('msgs')\n  return {\n    msgs: Msgs.find({}, { sort:{ time :-1} }).fetch(),\n    currentUser: Meteor.user(),\n  };\n}, App);"]},"hash":"c15f353598a99046e221f9ed72e41ab58a1ebdae"}
