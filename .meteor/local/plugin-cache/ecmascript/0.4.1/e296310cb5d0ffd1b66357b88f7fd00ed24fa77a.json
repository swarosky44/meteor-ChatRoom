{"metadata":{"usedHelpers":["taggedTemplateLiteralLoose","classCallCheck","inherits","possibleConstructorReturn","createClass","extends","toConsumableArray","objectWithoutProperties","objectDestructuringEmpty","slicedToArray","typeof","interopRequireDefault"],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/packages/ecmascript/runtime-tests.js","filenameRelative":"/packages/ecmascript/runtime-tests.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/ecmascript/runtime-tests.js.map","sourceFileName":"/packages/ecmascript/runtime-tests.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"runtime-tests"},"ignored":false,"code":"var _typeof2 = require('babel-runtime/helpers/typeof');\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _regenerator = require('babel-runtime/regenerator');\n\nvar _regenerator2 = _interopRequireDefault(_regenerator);\n\nvar _slicedToArray2 = require('babel-runtime/helpers/slicedToArray');\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _objectDestructuringEmpty2 = require('babel-runtime/helpers/objectDestructuringEmpty');\n\nvar _objectDestructuringEmpty3 = _interopRequireDefault(_objectDestructuringEmpty2);\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _taggedTemplateLiteralLoose2 = require('babel-runtime/helpers/taggedTemplateLiteralLoose');\n\nvar _taggedTemplateLiteralLoose3 = _interopRequireDefault(_taggedTemplateLiteralLoose2);\n\nvar _templateObject = (0, _taggedTemplateLiteralLoose3['default'])(['A', 'C'], ['\\\\u0041', 'C']);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nTinytest.add(\"ecmascript - runtime - template literals\", function (test) {\n  function dump(pieces) {\n    var copy = {};\n    // Can't use _.extend({}, pieces) because es5-shim adds enumerable\n    // methods to Array.prototype, and _.extend has no own property check.\n    _.each(_.keys(pieces), function (key) {\n      return copy[key] = pieces[key];\n    });\n    return [copy, _.toArray(arguments).slice(1)];\n  };\n  var foo = 'B';\n  // uses `babelHelpers.taggedTemplateLiteralLoose`\n  test.equal('A' + foo + 'C', 'ABC');\n  test.equal(dump(_templateObject, foo), [{ 0: 'A', 1: 'C', raw: ['\\\\u0041', 'C'] }, ['B']]);\n});\n\nTinytest.add(\"ecmascript - runtime - classes - basic\", function (test) {\n  {\n    (function () {\n      var Foo = function () {\n        function Foo(x) {\n          (0, _classCallCheck3['default'])(this, Foo);\n\n          this.x = x;\n        }\n\n        return Foo;\n      }();\n\n      test.throws(function () {\n        Foo(); // called without `new`\n      });\n\n      test.equal(new Foo(3).x, 3);\n    })();\n  }\n\n  {\n    (function () {\n      var Bar = function () {\n        function Bar(x) {\n          (0, _classCallCheck3['default'])(this, Bar);\n\n          this.x = x;\n        }\n\n        return Bar;\n      }();\n\n      var Foo = function (_Bar) {\n        (0, _inherits3['default'])(Foo, _Bar);\n\n        function Foo() {\n          (0, _classCallCheck3['default'])(this, Foo);\n          return (0, _possibleConstructorReturn3['default'])(this, _Bar.apply(this, arguments));\n        }\n\n        return Foo;\n      }(Bar);\n\n      test.throws(function () {\n        Foo(); // called without `new`\n      });\n\n      test.equal(new Foo(3).x, 3);\n      test.isTrue(new Foo(3) instanceof Foo);\n      test.isTrue(new Foo(3) instanceof Bar);\n    })();\n  }\n\n  {\n    var _Foo = function () {\n      function _Foo() {\n        (0, _classCallCheck3['default'])(this, _Foo);\n      }\n\n      _Foo.staticMethod = function () {\n        function staticMethod() {\n          return 'classy';\n        }\n\n        return staticMethod;\n      }();\n\n      _Foo.prototype.prototypeMethod = function () {\n        function prototypeMethod() {\n          return 'prototypical';\n        }\n\n        return prototypeMethod;\n      }();\n\n      return _Foo;\n    }();\n\n    test.equal(_Foo.staticMethod(), 'classy');\n    test.equal(new _Foo().prototypeMethod(), 'prototypical');\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - classes - use before declare\", function (test) {\n  var x = function () {\n    function asdf() {}\n\n    return asdf;\n  }();\n  if (typeof asdf === 'function') {\n    // We seem to be in IE 8, where function names leak into the enclosing\n    // scope, contrary to the spec.  In this case, Babel does not (currently)\n    // throw an error if you use a class before you declare it.  (Of course,\n    // any other browser can tell the developer they screwed up!)\n    test.expect_fail();\n  }\n\n  test.throws(function () {\n    new Foo(); // use before definition\n\n    var Foo = function () {\n      function Foo() {\n        (0, _classCallCheck3['default'])(this, Foo);\n      }\n\n      return Foo;\n    }();\n  });\n});\n\nTinytest.add(\"ecmascript - runtime - classes - inheritance\", function (test) {\n\n  // uses `babelHelpers.inherits`\n  {\n    var Foo = function () {\n      function Foo() {\n        (0, _classCallCheck3['default'])(this, Foo);\n      }\n\n      Foo.static1 = function () {\n        function static1() {\n          return 1;\n        }\n\n        return static1;\n      }();\n\n      return Foo;\n    }();\n\n    Foo.static2 = function () {\n      return 2;\n    };\n\n    // static methods are inherited!\n\n    var Bar = function (_Foo2) {\n      (0, _inherits3['default'])(Bar, _Foo2);\n\n      function Bar() {\n        (0, _classCallCheck3['default'])(this, Bar);\n        return (0, _possibleConstructorReturn3['default'])(this, _Foo2.apply(this, arguments));\n      }\n\n      return Bar;\n    }(Foo);\n\n    test.equal(Foo.static1(), 1);\n    test.equal(Foo.static2(), 2);\n    test.equal(Bar.static1(), 1);\n    test.equal(Bar.static2(), 2);\n  }\n\n  {\n    (function () {\n      var buf = [];\n\n      var Foo = function () {\n        function Foo() {\n          (0, _classCallCheck3['default'])(this, Foo);\n\n          buf.push('hi');\n        }\n\n        return Foo;\n      }();\n\n      var Bar = function (_Foo3) {\n        (0, _inherits3['default'])(Bar, _Foo3);\n\n        function Bar() {\n          (0, _classCallCheck3['default'])(this, Bar);\n          return (0, _possibleConstructorReturn3['default'])(this, _Foo3.apply(this, arguments));\n        }\n\n        return Bar;\n      }(Foo);\n\n      new Bar();\n      // derived class with no constructor gets a default constructor\n      // that calls the super constructor\n      test.equal(buf, ['hi']);\n    })();\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - classes - computed props\", function (test) {\n  {\n    (function () {\n      var frob = \"inc\";\n\n      var Foo = function () {\n        function Foo() {\n          (0, _classCallCheck3['default'])(this, Foo);\n        }\n\n        Foo[frob] = function (n) {\n          return n + 1;\n        };\n\n        return Foo;\n      }();\n\n      test.equal(Foo.inc(3), 4);\n    })();\n  }\n});\n\nif (Meteor.isServer) {\n  // getters and setters don't work in all clients, but they should work\n  // in classes on browsers that support them in the first place, and on\n  // the server.  (Technically they just need a working\n  // Object.defineProperty, found in IE9+ and all modern environments.)\n  Tinytest.add(\"ecmascript - runtime - classes - getters/setters\", function (test) {\n    // uses `babelHelpers.createClass`\n\n    var Foo = function () {\n      function Foo() {\n        (0, _classCallCheck3['default'])(this, Foo);\n      }\n\n      (0, _createClass3['default'])(Foo, [{\n        key: 'two',\n        get: function () {\n          function get() {\n            return 1 + 1;\n          }\n\n          return get;\n        }()\n      }], [{\n        key: 'three',\n        get: function () {\n          function get() {\n            return 1 + 1 + 1;\n          }\n\n          return get;\n        }()\n      }]);\n      return Foo;\n    }();\n\n    test.equal(new Foo().two, 2);\n    test.equal(Foo.three, 3);\n  });\n}\n\nTinytest.add(\"ecmascript - runtime - block scope\", function (test) {\n  {\n    (function () {\n      var print = function print(x) {\n        buf.push(x);\n      };\n\n      var doLater = function doLater(f) {\n        thunks.push(f);\n      };\n\n      var buf = [];\n      var thunks = [];\n      ;\n      ;\n\n      for (var i = 0; i < 3; i++) {\n        print(i);\n      }\n      test.equal(buf, [0, 1, 2]);\n      buf.length = 0;\n\n      var _loop = function _loop(_i) {\n        doLater(function () {\n          print(_i);\n        });\n      };\n\n      for (var _i = 0; _i < 3; _i++) {\n        _loop(_i);\n      }\n\n      _.each(thunks, function (f) {\n        return f();\n      });\n      test.equal(buf, [0, 1, 2]);\n    })();\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - classes - super\", function (test) {\n  {\n    (function () {\n      var Class1 = function () {\n        function Class1() {\n          (0, _classCallCheck3['default'])(this, Class1);\n        }\n\n        Class1.prototype.foo = function () {\n          function foo() {\n            return 123;\n          }\n\n          return foo;\n        }();\n\n        Class1.bar = function () {\n          function bar() {\n            return 1;\n          }\n\n          return bar;\n        }();\n\n        return Class1;\n      }();\n\n      var Class2 = function (_Class) {\n        (0, _inherits3['default'])(Class2, _Class);\n\n        function Class2() {\n          (0, _classCallCheck3['default'])(this, Class2);\n          return (0, _possibleConstructorReturn3['default'])(this, _Class.apply(this, arguments));\n        }\n\n        return Class2;\n      }(Class1);\n\n      var Class3 = function (_Class2) {\n        (0, _inherits3['default'])(Class3, _Class2);\n\n        function Class3() {\n          (0, _classCallCheck3['default'])(this, Class3);\n          return (0, _possibleConstructorReturn3['default'])(this, _Class2.apply(this, arguments));\n        }\n\n        Class3.prototype.foo = function () {\n          function foo() {\n            return _Class2.prototype.foo.call(this) + Class3.bar();\n          }\n\n          return foo;\n        }();\n\n        return Class3;\n      }(Class2);\n\n      test.equal(new Class3().foo(), 124);\n    })();\n  }\n\n  {\n    var Foo = function () {\n      function Foo(value) {\n        (0, _classCallCheck3['default'])(this, Foo);\n        this.value = value;\n      }\n\n      Foo.prototype.x = function () {\n        function x() {\n          return this.value;\n        }\n\n        return x;\n      }();\n\n      return Foo;\n    }();\n\n    var Bar = function (_Foo4) {\n      (0, _inherits3['default'])(Bar, _Foo4);\n\n      function Bar() {\n        (0, _classCallCheck3['default'])(this, Bar);\n        return (0, _possibleConstructorReturn3['default'])(this, _Foo4.call(this, 123));\n      }\n\n      Bar.prototype.x = function () {\n        function x() {\n          return _Foo4.prototype.x.call(this);\n        }\n\n        return x;\n      }();\n\n      return Bar;\n    }(Foo);\n\n    test.equal(new Bar().x(), 123);\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - object rest/spread\", function (test) {\n  var middle = { b: 2, c: 3 };\n  // uses `babelHelpers._extends`\n  var full = (0, _extends3['default'])({ a: 1 }, middle, { d: 4 });\n  test.equal(full, { a: 1, b: 2, c: 3, d: 4 });\n});\n\nTinytest.add(\"ecmascript - runtime - spread args to new\", function (test) {\n\n  var Foo = function Foo(one, two, three) {\n    test.isTrue(this instanceof Foo);\n    test.equal(one, 1);\n    test.equal(two, 2);\n    test.equal(three, 3);\n    this.created = true;\n  };\n\n  var oneTwo = [1, 2];\n\n  // uses `babelHelpers.bind`\n  var foo = new (Function.prototype.bind.apply(Foo, [null].concat(oneTwo, [3])))();\n  test.isTrue(foo.created);\n});\n\nTinytest.add(\"ecmascript - runtime - Map spread\", function (test) {\n  var map = new Map();\n\n  map.set(0, 1);\n  map.set(1, 2);\n  map.set(2, 3);\n\n  test.equal([].concat((0, _toConsumableArray3['default'])(map)), [[0, 1], [1, 2], [2, 3]]);\n});\n\nTinytest.add(\"ecmascript - runtime - Set spread\", function (test) {\n  var set = new Set();\n\n  set.add(\"a\");\n  set.add(1);\n  set.add(false);\n\n  test.equal([].concat((0, _toConsumableArray3['default'])(set)), [\"a\", 1, false]);\n});\n\nTinytest.add(\"ecmascript - runtime - destructuring\", function (test) {\n  // uses `babelHelpers.objectWithoutProperties` and\n  // `babelHelpers.objectDestructuringEmpty`\n\n  var obj = { a: 1, b: 2 };\n  var a = obj.a;\n  var rest = (0, _objectWithoutProperties3['default'])(obj, ['a']);\n\n  test.equal(a, 1);\n  test.equal(rest, { b: 2 });\n\n  var _ref = {};\n  (0, _objectDestructuringEmpty3['default'])(_ref);\n\n\n  test.throws(function () {\n    var _ref2 = null;\n    (0, _objectDestructuringEmpty3['default'])(_ref2);\n  }, /Cannot destructure undefined/);\n\n  var _ref3 = _regenerator2['default'].mark(function () {\n    function _callee() {\n      var x;\n      return _regenerator2['default'].wrap(function () {\n        function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                x = 1;\n\n              case 1:\n                if (!true) {\n                  _context.next = 6;\n                  break;\n                }\n\n                _context.next = 4;\n                return x++;\n\n              case 4:\n                _context.next = 1;\n                break;\n\n              case 6:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }\n\n        return _callee$;\n      }(), _callee, this);\n    }\n\n    return _callee;\n  }())();\n\n  var _ref4 = (0, _slicedToArray3['default'])(_ref3, 3);\n\n  var x = _ref4[0];\n  var y = _ref4[1];\n  var z = _ref4[2];\n\n\n  test.equal(x, 1);\n  test.equal(y, 2);\n  test.equal(z, 3);\n});\n\nTinytest.addAsync(\"ecmascript - runtime - misc support\", function (test, done) {\n  // Verify that the runtime was installed.\n  test.equal(typeof meteorBabelHelpers === 'undefined' ? 'undefined' : (0, _typeof3['default'])(meteorBabelHelpers), \"object\");\n  test.equal((0, _typeof3['default'])(meteorBabelHelpers.sanitizeForInObject), \"function\");\n\n  var Base = function () {\n    function Base() {\n      var _this7 = this;\n\n      (0, _classCallCheck3['default'])(this, Base);\n\n      this.sum = 0;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      args.forEach(function (arg) {\n        return _this7.sum += arg;\n      });\n    }\n\n    Base.inherited = function () {\n      function inherited() {\n        return \"inherited\";\n      }\n\n      return inherited;\n    }();\n\n    return Base;\n  }();\n\n  var Derived = function (_Base) {\n    (0, _inherits3['default'])(Derived, _Base);\n\n    function Derived() {\n      (0, _classCallCheck3['default'])(this, Derived);\n      return (0, _possibleConstructorReturn3['default'])(this, _Base.call(this, 1, 2, 3));\n    }\n\n    return Derived;\n  }(Base);\n\n  // Check that static methods are inherited.\n\n\n  test.equal(Derived.inherited(), \"inherited\");\n\n  var d = new Derived();\n  test.equal(d.sum, 6);\n\n  var expectedError = new Error(\"expected\");\n\n  Promise.resolve(\"working\").then(function (result) {\n    test.equal(result, \"working\");\n    throw expectedError;\n  })['catch'](function (error) {\n    test.equal(error, expectedError);\n    if (Meteor.isServer) {\n      var Fiber = Npm.require(\"fibers\");\n      // Make sure the Promise polyfill runs callbacks in a Fiber.\n      test.instanceOf(Fiber.current, Fiber);\n    }\n  }).then(done, function (error) {\n    return test.exception(error);\n  });\n});","ast":null,"map":{"version":3,"sources":["/packages/ecmascript/runtime-tests.js"],"names":[],"mappings":"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","file":"/packages/ecmascript/runtime-tests.js.map","sourcesContent":["Tinytest.add(\"ecmascript - runtime - template literals\", (test) => {\n  function dump(pieces) {\n    var copy = {};\n    // Can't use _.extend({}, pieces) because es5-shim adds enumerable\n    // methods to Array.prototype, and _.extend has no own property check.\n    _.each(_.keys(pieces), key => copy[key] = pieces[key]);\n    return [copy, _.toArray(arguments).slice(1)];\n  };\n  const foo = 'B';\n  // uses `babelHelpers.taggedTemplateLiteralLoose`\n  test.equal(`\\u0041${foo}C`, 'ABC');\n  test.equal(dump`\\u0041${foo}C`,\n             [{0:'A', 1: 'C', raw: ['\\\\u0041', 'C']},\n              ['B']]);\n});\n\nTinytest.add(\"ecmascript - runtime - classes - basic\", (test) => {\n  {\n    class Foo {\n      constructor(x) {\n        this.x = x;\n      }\n    }\n\n    test.throws(() => {\n      Foo(); // called without `new`\n    });\n\n    test.equal((new Foo(3)).x, 3);\n  }\n\n  {\n    class Bar {\n      constructor(x) {\n        this.x = x;\n      }\n    }\n    class Foo extends Bar {}\n\n    test.throws(() => {\n      Foo(); // called without `new`\n    });\n\n    test.equal((new Foo(3)).x, 3);\n    test.isTrue((new Foo(3)) instanceof Foo);\n    test.isTrue((new Foo(3)) instanceof Bar);\n  }\n\n  {\n    class Foo {\n      static staticMethod() {\n        return 'classy';\n      }\n\n      prototypeMethod() {\n        return 'prototypical';\n      }\n    }\n\n    test.equal(Foo.staticMethod(), 'classy');\n    test.equal((new Foo).prototypeMethod(), 'prototypical');\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - classes - use before declare\", (test) => {\n  const x = function asdf() {};\n  if (typeof asdf === 'function') {\n    // We seem to be in IE 8, where function names leak into the enclosing\n    // scope, contrary to the spec.  In this case, Babel does not (currently)\n    // throw an error if you use a class before you declare it.  (Of course,\n    // any other browser can tell the developer they screwed up!)\n    test.expect_fail();\n  }\n\n  test.throws(() => {\n    new Foo(); // use before definition\n    class Foo {}\n  });\n});\n\n\nTinytest.add(\"ecmascript - runtime - classes - inheritance\", (test) => {\n\n  // uses `babelHelpers.inherits`\n  {\n    class Foo {\n      static static1() {\n        return 1;\n      }\n    }\n    Foo.static2 = function () {\n      return 2;\n    };\n\n    // static methods are inherited!\n    class Bar extends Foo {}\n\n    test.equal(Foo.static1(), 1);\n    test.equal(Foo.static2(), 2);\n    test.equal(Bar.static1(), 1);\n    test.equal(Bar.static2(), 2);\n  }\n\n  {\n    const buf = [];\n    class Foo {\n      constructor() {\n        buf.push('hi');\n      }\n    }\n\n    class Bar extends Foo {}\n\n    new Bar();\n    // derived class with no constructor gets a default constructor\n    // that calls the super constructor\n    test.equal(buf, ['hi']);\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - classes - computed props\", (test) => {\n  {\n    const frob = \"inc\";\n\n    class Foo {\n      static [frob](n) { return n+1; }\n    }\n\n    test.equal(Foo.inc(3), 4);\n  }\n});\n\nif (Meteor.isServer) {\n  // getters and setters don't work in all clients, but they should work\n  // in classes on browsers that support them in the first place, and on\n  // the server.  (Technically they just need a working\n  // Object.defineProperty, found in IE9+ and all modern environments.)\n  Tinytest.add(\"ecmascript - runtime - classes - getters/setters\", (test) => {\n    // uses `babelHelpers.createClass`\n    class Foo {\n      get two() { return 1+1; }\n      static get three() { return 1+1+1; }\n    }\n\n    test.equal((new Foo).two, 2);\n    test.equal(Foo.three, 3);\n  });\n}\n\nTinytest.add(\"ecmascript - runtime - block scope\", (test) => {\n  {\n    const buf = [];\n    const thunks = [];\n    function print(x) {\n      buf.push(x);\n    };\n    function doLater(f) {\n      thunks.push(f);\n    };\n\n    for (let i = 0; i < 3; i++) {\n      print(i);\n    }\n    test.equal(buf, [0, 1, 2]);\n    buf.length = 0;\n\n    for (let i = 0; i < 3; i++) {\n      doLater(() => {\n        print(i);\n      });\n    }\n\n    _.each(thunks, f => f());\n    test.equal(buf, [0, 1, 2]);\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - classes - super\", (test) => {\n  {\n    class Class1 {\n      foo() { return 123; }\n      static bar() { return 1; }\n    }\n    class Class2 extends Class1 {}\n    class Class3 extends Class2 {\n      foo() {\n        return super.foo() + Class3.bar();\n      }\n    }\n\n    test.equal((new Class3).foo(), 124);\n  }\n\n  {\n    class Foo {\n      constructor(value) { this.value = value; }\n      x() { return this.value; }\n    }\n\n    class Bar extends Foo {\n      constructor() { super(123); }\n      x() { return super.x(); }\n    }\n\n    test.equal((new Bar).x(), 123);\n  }\n});\n\nTinytest.add(\"ecmascript - runtime - object rest/spread\", (test) => {\n  const middle = {b:2, c:3};\n  // uses `babelHelpers._extends`\n  const full = {a:1, ...middle, d:4};\n  test.equal(full, {a:1, b:2, c:3, d:4});\n});\n\nTinytest.add(\"ecmascript - runtime - spread args to new\", (test) => {\n\n  const Foo = function (one, two, three) {\n    test.isTrue(this instanceof Foo);\n    test.equal(one, 1);\n    test.equal(two, 2);\n    test.equal(three, 3);\n    this.created = true;\n  };\n\n  const oneTwo = [1, 2];\n\n  // uses `babelHelpers.bind`\n  const foo = new Foo(...oneTwo, 3);\n  test.isTrue(foo.created);\n});\n\nTinytest.add(\"ecmascript - runtime - Map spread\", (test) => {\n  const map = new Map;\n\n  map.set(0, 1);\n  map.set(1, 2);\n  map.set(2, 3);\n\n  test.equal([...map], [\n    [0, 1],\n    [1, 2],\n    [2, 3]\n  ]);\n});\n\nTinytest.add(\"ecmascript - runtime - Set spread\", (test) => {\n  const set = new Set;\n\n  set.add(\"a\");\n  set.add(1);\n  set.add(false);\n\n  test.equal([...set], [\"a\", 1, false]);\n});\n\nTinytest.add(\"ecmascript - runtime - destructuring\", (test) => {\n  // uses `babelHelpers.objectWithoutProperties` and\n  // `babelHelpers.objectDestructuringEmpty`\n\n  const obj = {a:1, b:2};\n  const {a, ...rest} = obj;\n  test.equal(a, 1);\n  test.equal(rest, {b:2});\n\n  const {} = {};\n\n  test.throws(() => {\n    const {} = null;\n  }, /Cannot destructure undefined/);\n\n  const [x, y, z] = function*() {\n    let x = 1;\n    while (true) {\n      yield x++;\n    }\n  }();\n\n  test.equal(x, 1);\n  test.equal(y, 2);\n  test.equal(z, 3);\n});\n\nTinytest.addAsync(\"ecmascript - runtime - misc support\", (test, done) => {\n  // Verify that the runtime was installed.\n  test.equal(typeof meteorBabelHelpers, \"object\");\n  test.equal(typeof meteorBabelHelpers.sanitizeForInObject, \"function\");\n\n  class Base {\n    constructor(...args) {\n      this.sum = 0;\n      args.forEach(arg => this.sum += arg);\n    }\n\n    static inherited() {\n      return \"inherited\";\n    }\n  }\n\n  class Derived extends Base {\n    constructor() {\n      super(1, 2, 3);\n    }\n  }\n\n  // Check that static methods are inherited.\n  test.equal(Derived.inherited(), \"inherited\");\n\n  const d = new Derived();\n  test.equal(d.sum, 6);\n\n  const expectedError = new Error(\"expected\");\n\n  Promise.resolve(\"working\").then(result => {\n    test.equal(result, \"working\");\n    throw expectedError;\n  }).catch(error => {\n    test.equal(error, expectedError);\n    if (Meteor.isServer) {\n      const Fiber = Npm.require(\"fibers\");\n      // Make sure the Promise polyfill runs callbacks in a Fiber.\n      test.instanceOf(Fiber.current, Fiber);\n    }\n  }).then(done, error => test.exception(error));\n});\n"]},"hash":"e296310cb5d0ffd1b66357b88f7fd00ed24fa77a"}
